var hPageHeaderID="ph";var ItemDisplayPath=new Array(24);var ItemEditPath=new Array(24);ItemEditPath[1]="/folder/edit";ItemDisplayPath[1]="/folder/";ItemEditPath[2]="/folder/edit";ItemDisplayPath[2]="/folder/";ItemEditPath[3]="/file/edit";ItemDisplayPath[3]="/file/";ItemEditPath[4]="/Content/Messages/MessageAddEdit.aspx";ItemDisplayPath[4]="/Content/Messages/MessageDisplay.aspx";ItemEditPath[5]="/Content/HTMLPages/HTMLPageAddEdit.aspx";ItemDisplayPath[5]="/Content/HTMLPages/HTMLPageDisplay.aspx";ItemEditPath[6]="/Content/Calendars/CalendarAddEdit.aspx";ItemDisplayPath[6]="/Content/Calendars/Month.aspx";ItemEditPath[7]="/Content/Calendars/EventAddEdit.aspx";ItemDisplayPath[7]="/Content/Calendars/EventDisplay.aspx";ItemEditPath[8]="/project/edit";ItemDisplayPath[8]="/project/display";ItemEditPath[9]="/task/edit";ItemDisplayPath[9]="/task/display";ItemEditPath[10]="/Content/ToDos/ToDoAddEdit.aspx";ItemDisplayPath[10]="/Content/ToDos/ToDoDisplay.aspx";ItemDisplayPath[11]="/content/dashboard/default.aspx";ItemEditPath[12]="";ItemDisplayPath[12]="";ItemEditPath[13]="/Content/Communities/CommunityAddEdit.aspx";ItemDisplayPath[13]="/Content/Communities/CommunityDisplay.aspx";ItemEditPath[14]="/Content/Communities/CommunityPlanAddEdit.aspx";ItemDisplayPath[14]="/Content/Communities/CommunityPlanDisplay.aspx";ItemEditPath[15]="/Content/Communities/CommunityElevationAddEdit.aspx";ItemDisplayPath[15]="/Content/Communities/CommunityElevationDisplay.aspx";ItemEditPath[16]="/Content/Communities/CommunityLotAddEdit.aspx";ItemDisplayPath[16]="/Content/Communities/CommunityLotDisplay.aspx";ItemEditPath[17]="/Content/Emails/EmailAddEdit.aspx";ItemDisplayPath[17]="/Content/Emails/EmailDisplay.aspx";ItemEditPath[18]="/Content/CustomItems/ItemAddEdit.aspx";ItemDisplayPath[18]="/Content/CustomItems/ItemDisplay.aspx";ItemEditPath[21]="/issue/edit";ItemDisplayPath[21]="/issue/display";ItemEditPath[22]="/approval-request/edit";ItemDisplayPath[22]="/approval-request/display";ItemEditPath[23]="/Content/Shortcuts/ShortcutAddEdit.aspx";ItemDisplayPath[23]="/Content/Shortcuts/ShortcutDisplay.aspx";ItemEditPath[24]="/Content/Projects/ProjectRequestAddEdit.aspx";ItemDisplayPath[24]="/Content/Projects/ProjectRequestDisplay.aspx";ItemEditPath[25]="/Content/Workflows/WorkflowAddEdit.aspx";ItemDisplayPath[25]="/Content/Workflows/WorkflowDisplay.aspx";ItemEditPath[26]="/project/change-order/add/";ItemDisplayPath[26]="/project/change-order/display/";ItemEditPath[27]="/project/iteration/add";ItemDisplayPath[27]="/project/backlog/";ItemEditPath[28]="/error-queue/add";ItemDisplayPath[28]="/error-queue/display";ItemEditPath[30]="/proposal/edit";ItemDisplayPath[30]="/proposal/display";function HRoboHelpContextHelpF1(){};function GlobalF1KeyInvokeContextHelp(){HRoboHelpContextHelpF1();};function N(element,itemType){var row=ph_fll.GetRowContainingElement(element);var id=row.id;id=id.replace(hPageHeaderID+"_","");return VI(itemType,id);};function AI(itemType,idContainer,addQueryParamString){if(addQueryParamString==null){addQueryParamString="";}else if(addQueryParamString!=""&&addQueryParamString.indexOf("&")!=0){addQueryParamString="&"+addQueryParamString;}return L(ItemEditPath[itemType]+"?IdContainer="+idContainer+addQueryParamString);};function EI(itemType,id,idContainer,openInNewWindow){var link=ItemEditPath[itemType]+"?Id="+id;if(idContainer){link+="&IdContainer="+idContainer;}return L(link,false,openInNewWindow);};function VI(itemType,id,openInNewWindow,additionalParams){if(!isBoolean(openInNewWindow)){openInNewWindow=false;}if(additionalParams==null){additionalParams="";}else if(additionalParams!=""&&additionalParams.indexOf("&")!=0){additionalParams="&"+additionalParams;}return L(ItemDisplayPath[itemType]+"/"+id+additionalParams,false,openInNewWindow);};function DI(id,confirmMessage){if(confirmMessage){if(!confirm(confirmMessage)){return false;}}return L("/Content/ItemDelete.aspx?Id="+id);};function DIH(url,confirmMessage){if(confirm(confirmMessage)){return L(url,true);}else{return false;}};function E(itemType,guidArrayIndex,guidContainerArrayIndex){return EI(itemType,GuidArray[guidArrayIndex],GuidArray[guidContainerArrayIndex]);};function V(itemType,guidArrayIndex){return VI(itemType,GuidArray[guidArrayIndex]);};function D(guidArrayIndex){return DI(GuidArray[guidArrayIndex]);};function CalD(calendarId,date){return L("/Content/Calendars/Day.aspx?Id="+calendarId+"&Date="+escape(date));};function CalW(calendarId,date){return L("/Content/Calendars/Week.aspx?Id="+calendarId+"&Date="+escape(date));};function CalM(calendarId,date){return L("/Content/Calendars/Month.aspx?Id="+calendarId+"&Date="+escape(date));};function CalY(calendarId,date){return L("/Content/Calendars/Year.aspx?Id="+calendarId+"&Date="+escape(date));};function CalendarNavigatorDateChangedDay(pTBId,vDate){var calendarId=GetElementById("calendarIdValue").value;CalD(calendarId,GetElementById(pTBId).value);};function CalendarNavigatorDateChangedWeek(pTBId,vDate){var calendarId=GetElementById("calendarIdValue").value;CalW(calendarId,GetElementById(pTBId).value);};function CalendarNavigatorDateChangedMonth(pTBId,vDate){var calendarId=GetElementById("calendarIdValue").value;CalM(calendarId,GetElementById(pTBId).value);};function CalendarNavigatorDateChangedYear(pTBId,vDate){var calendarId=GetElementById("calendarIdValue").value;CalY(calendarId,GetElementById(pTBId).value);};function ClearSearchOnFocus(element){if(element){if(element.value=="Quick Search"){element.value="";}}};function OFW(link){window.open(link,'FeaturesWindow',toolbars='yes',width=800,height=600,resizable='yes');return false;};function EmailPageMailTo(url){var w=window.open(url);if(!BrowserTools.IsInternetExplorer()){w.close();}return false;};function LNavBoxToggle(tableName){var table=GetElementById(tableName);var hide=true;if(table.style.display=="none"){hide=false;}$(table).toggle("blind");MAPBB(hPageHeaderID+":leftNavBoxShowHide",tableName+"|"+hide,false,null,"",false,false);};function HLNavBoxResize(type){PaneResizerMouseUp();MAPBB(hPageHeaderID+":leftNavBoxResize",type,false,null,"",false,false);};function HLNavExpCol(postBackUniqueID){var navIsCollapsed=FormTools.GetFormElementValue(hPageHeaderID+"__NIC");var navIsOutput=FormTools.GetFormElementValue(hPageHeaderID+"__NIO");var hide=true;if(navIsCollapsed=="1"){hide=false;FormTools.SetFormElementValue(hPageHeaderID+"__NIC","0");}else{FormTools.SetFormElementValue(hPageHeaderID+"__NIC","1");}$("#hNavCell").toggle();$("#hContentDivider").toggle();$("#fNavCell").toggle();$("#fContentDivider").toggle();var elementToShowProcessingNear=null;if(hide==false&&navIsOutput=="0"){elementToShowProcessingNear=GetElementById("hLNavMainDiv");};MAPBB(postBackUniqueID,"",false,elementToShowProcessingNear,"Processing...",false,false);OnWindowResizeFunctions.CallFunctions();};function HNavResizeStop(postBackUniqueID){PaneResizerMouseUp();PageHeaderAnchorElementsToWindowRight();MAPBB(postBackUniqueID,"",false,null,"",false,false);};function PageHeaderGlobalPageLoad(){PageHeaderAnchorElementsToWindowRight();};function PageHeaderGlobalWindowScroll(){PageHeaderAnchorElementsToWindowRight();};function PageHeaderGlobalWindowResize(){PageHeaderAnchorElementsToWindowRight();};function PageHeaderEnsureNavBarWidthHonoredForChromeSafari(){};function PageHeaderRedrawKendoUICharts(){var $chartRefreshButtons=$(".chart-refresh-button");if($chartRefreshButtons!=null&&$chartRefreshButtons.length){for(var i=0;i<$chartRefreshButtons.length;i++){var chartRefreshButton=$chartRefreshButtons[i];var chartId=$(chartRefreshButton).data("chartid");var chartDiv=GetElementById(chartId+"_c");if(chartDiv&&$(chartDiv).data("role")=="chart"){var redrawCommand=$(chartRefreshButton).data("redrawcommand");if(redrawCommand&&redrawCommand!=""){eval(redrawCommand);}}}}};function HRoboHelpContextHelp(tabControlObject,helpBaseURL,helpTopicId){if(tabControlObject!=null&&(helpTopicId==null||helpTopicId=="")){helpTopicId=tabControlObject.GetSelectedTabHelpTopicId();}window.open(helpBaseURL+'#cshid='+helpTopicId,'toolbars=no, resizable=yes');};function HAdjustSearchBoxValue(searchBox){searchBox.value=(searchBox.value=="Quick Search")?"":searchBox.value;};function HPrintFriendly(returnToFullPage,printFriendly){var hide=!returnToFullPage;var $returnAnchors=$('.pi-print-friendly-return');if($returnAnchors!=null&&$returnAnchors.length>0){var returnAnchor=$returnAnchors[0];UITools.ToggleDisplay(returnAnchor,!hide);}if(returnToFullPage==false){var thead=$('table.DataList thead');if(thead.length==0){$('<thead></thead>').prependTo('table.DataList');}var displayDataListTable=$('table.DataList');if(displayDataListTable&&displayDataListTable.length>0){for(var i=0;i<displayDataListTable.length;i++){var t=displayDataListTable[i];if(t.tBodies&&t.tBodies.length>0){if(t.tBodies[0].rows&&t.tBodies[0].rows.length>0){$(t.tHead).append(t.tBodies[0].rows[0]);}}}}}else{var displayDataListTable=$('table.DataList');if(displayDataListTable&&displayDataListTable.length>0){for(var i=0;i<displayDataListTable.length;i++){var t=displayDataListTable[i];if(t.tBodies&&t.tBodies.length>0){if(t.tHead&&t.tHead.rows.length>0){$(t.tHead.rows[0]).prependTo(t.tBodies);$(t.tHead.rows[0]).remove();}}}}}if((printFriendly!=null&&printFriendly==true)||hide==false){HPrintFriendlyElements(hide);}OnWindowResizeFunctions.CallFunctions();if(returnToFullPage){HPrintFriendly_AfterReturnToFullPage();}else{HPrintFriendly_AfterPrintFriendly();}return false;};function HPrintFriendlyElements(hide){var $pfelements=$(".HOPF");if(hide){$pfelements.each(function(index,element){var $element=$(this);$element.css("display","none");});}else{$pfelements.each(function(index,element){var $element=$(this);$element.css("display","");});}};function HPrintFriendly_AfterPrintFriendly(){};function HPrintFriendly_AfterReturnToFullPage(){};function BannerMenu_JavaScriptOnBeforeAjaxMenuItemClickedPostBack(element,commandName,eventArguments){FormTools.SetFormElementValue(hPageHeaderID+'__MLURL',ReturnUrl);FormTools.SetFormElementValue(hPageHeaderID+'__MLHtmlTitle',document.title);if(commandName=="exporttopdf:"){return PDFDisplayOptionsLoadAndDisplayLayer();}return true;};var ph_co=null;function HHShowMainPageContextMenu(localEvent){if(ph_co){ph_co.ContextMenuShow(localEvent);}};function ChangeCss(theClass,element,value){alert("use jQuery to perform the ChangeCSS operation");return;};function LnScrollOn(element){if(element.style.overflowY!="auto"){element.style.overflowY='auto';}};function LnScrollOff(element){element.style.overflowY='hidden';};function OnItClicked(anchor,id){var jAnchor=$(anchor);var jImage=jAnchor.children("img");var image=jImage.attr("src").toString();var addToList=true;if(image.indexOf("-o")>=0){addToList=false;image=MFImg.OnIt;}else{image=MFImg.OnItRemove;}var command=addToList.toString().toLowerCase()+"_"+id;jImage.attr("src",image);MAPBB('onit',command,false);return false;};function ValidateClientAppVersion(currentServerVersion){if(currentServerVersion!=CurrentPIClientVersion){UITools.ShowAlertBox('Project Insight has been updated.  Please refresh your browser before preceding.','Application Update');}else{setTimeout(function(){GetCurerentPIServerVersion()},CurrentPIVersionServerCheckInterval);}};function GetCurerentPIServerVersion(){MAPBB('ph$validateVersion','',false);};function ExportToWord(tableID,templateID,root){if(!root){root="";}var params=new Object();params["ids"]=MetafuseTable_GetTableAllRowIDs(tableID);params["tid"]=templateID;FormTools.WindowOpenWithPost(root+"/export/word",params,null,null);}