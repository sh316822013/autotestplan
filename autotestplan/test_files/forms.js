PI.Forms=new Object();var GlobalModalFormsSingleInstance_ShowBillingLevels=null;var GlobalModalFormsSingleInstance_UserInvite=null;var GlobalModalFormsSingleInstance_UserDisplay=null;var GlobalModalFormsSingleInstance_TaskDisplay=null;var GlobalModalFormsSingleInstance_AddTask=null;var GlobalModalFormsSingleInstance_AddCreditCard=null;PI.Forms.ShowCard=function(url,event,width,height){var mobileModalWidth='';if($(window).width()<415){mobileModalWidth=$(window).width()*.9;}var modal=UITools.ShowAlertBox('<div id="ModalLoadingSpinner" style="width:'+mobileModalWidth+'px; min-height:350px;" class="W100 AC"'+Root+'/i/processing.gif"></div>','',false,width);PI.Forms.VerifySingleInstance(url,modal);$('#'+modal.id).css("background-color","#ffffff");$('#'+modal.id+' tbody tr:nth-child(2)').load(Root+url,null,function(){$('#ModalLoadingSpinner').remove();$('#'+modal.id+' tbody tr:nth-child(2) > div').css("margin","10px 0px 0px 15px");PI.Forms.LoadCardImages();UITools.ShowAtCenterScreen(modal);});UITools.CancelBubble(event);return modal.id;};PI.Forms.HideCard=function(url){};PI.Forms.HideVeilAndCloseLayer=function(id){pi.UI.DraggableLayerManager.Remove(id);metafuseVeil.HideVeilUnderElement(id);};PI.Forms.LoadCardImages=function(){$('#AddInvitationButton').attr('src',pi.UI.GetIconPath("Add"));$('.RemoveRow').attr('src',pi.UI.GetIconPath("Delete"));};PI.Forms.VerifySingleInstance=function(url,modal){if(url.indexOf("show-billing-levels")>=0){if(GlobalModalFormsSingleInstance_ShowBillingLevels!=null){$('#'+GlobalModalFormsSingleInstance_ShowBillingLevels).remove();}GlobalModalFormsSingleInstance_ShowBillingLevels=modal.id;}else if(url.indexOf("user-invite")>=0){if(GlobalModalFormsSingleInstance_UserInvite!=null){$('#'+GlobalModalFormsSingleInstance_UserInvite).remove();}GlobalModalFormsSingleInstance_UserInvite=modal.id;}else if(url.indexOf("user-display")>=0){if(GlobalModalFormsSingleInstance_UserDisplay!=null){$('#'+GlobalModalFormsSingleInstance_UserDisplay).remove();}GlobalModalFormsSingleInstance_UserDisplay=modal.id;}else if(url.indexOf("task-display")>=0){if(GlobalModalFormsSingleInstance_TaskDisplay!=null){$('#'+GlobalModalFormsSingleInstance_TaskDisplay).remove();}GlobalModalFormsSingleInstance_TaskDisplay=modal.id;}else if(url.indexOf("add-task")>=0){if(GlobalModalFormsSingleInstance_AddTask!=null){$('#'+GlobalModalFormsSingleInstance_AddTask).remove();}GlobalModalFormsSingleInstance_AddTask=modal.id;}else if(url.indexOf("add-credit-card")>=0){if(GlobalModalFormsSingleInstance_AddCreditCard!=null){$('#'+GlobalModalFormsSingleInstance_AddCreditCard).remove();}GlobalModalFormsSingleInstance_AddCreditCard=modal.id;}};PI.Forms.ValidateDateRange=function(startDate,endDate,dateFormat){if(startDate&&endDate){var usedDateFormat='mm/dd/yyy';var startBits=startDate.split('/');var starty=startBits[2],startd=startBits[1],startm=startBits[0];var endBits=endDate.split('/');var endy=endBits[2],endd=endBits[1],endm=endBits[0];if(dateFormat=='dd/mm/yyy'){usedDateFormat='dd/mm/yyy';var ph=startd;startd=startm;startm=ph;ph=endd;endd=endm;endm=ph;}var startDaysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];var endDaysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];if((!(starty%4)&&starty%100)||!(starty%400)){startDaysInMonth[1]=29;}if((!(endy%4)&&starty%100)||!(starty%400)){endDaysInMonth[1]=29;}if(!(!(/\D/.test(String(startd)))&&startd>0&&startd<=startDaysInMonth[--startm])){UITools.ShowAlertBox("Start Date is not valid. Please enter as "+usedDateFormat);return false;}if(!(!(/\D/.test(String(endd)))&&endd>0&&endd<=endDaysInMonth[--endm])){UITools.ShowAlertBox("End Date is not valid. Please enter as "+usedDateFormat);return false;}if(new Date(endDate)<new Date(startDate)){UITools.ShowAlertBox("End Date must be greater than Start Date");return false;}return true;}else{UITools.ShowAlertBox("Please enter a start and end date....");return false;}};PI.Forms.ValidateEmail=function(email){var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email);};