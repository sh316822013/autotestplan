String.prototype.endsWith=function(suffix){return this.indexOf(suffix,this.length-suffix.length)!==-1;};var AdditionalHiddenElementNamesToAppendToReturnUrl=null;var Root="";var RootSuffix="";var PreviousPageUrl="";var ReturnURL="";var PICDN="";var jQueryMobileInputRefreshEnabled=false;var metafuseGlobalCancelAppendReturnUrl=false;var metafuseGlobalHttpProtocolAndServerName="";var metafuseGlobalLinkOpenInNewWindow=null;function L(scriptPath,excludeReturnUrl,openInNewWindow){var url=PI_HyperLinkConstruct_Private(scriptPath,excludeReturnUrl);if(openInNewWindow){window.open(url,"_blank");}else{window.location.href=url;}return false;};function PI_HyperLinkConstruct_Private(scriptPath,excludeReturnUrl){var hyperLink=scriptPath;var hyperlinkToTest=hyperLink.toLowerCase();if(hyperlinkToTest.indexOf('/dl/')>=0){excludeReturnUrl=true;}if(hyperlinkToTest.indexOf("http://",0)!=0&&hyperlinkToTest.indexOf("https://",0)!=0){var rootAppend="";if(RootSuffix.length>0){var base=$("base");if(base!=null&&base.length>0){RootSuffix="";}}if(Root!=""&&hyperlinkToTest.indexOf(Root.toLowerCase())!=0){rootAppend+=Root;if(RootSuffix!=""&&hyperlinkToTest.indexOf(RootSuffix.toLowerCase())!=0){rootAppend+=RootSuffix;}}else if(Root!=""){if(RootSuffix!=""&&hyperlinkToTest.indexOf(RootSuffix.toLowerCase())!=0){hyperLink=hyperlinkToTest.replace(Root.toLowerCase(),(Root.toLowerCase()+RootSuffix.toLowerCase()));}}else{if(RootSuffix!=""&&hyperlinkToTest.indexOf(RootSuffix.toLowerCase())!=0){rootAppend+=RootSuffix;}}hyperLink=metafuseGlobalHttpProtocolAndServerName+rootAppend+hyperLink;}var url="";if(excludeReturnUrl||metafuseGlobalCancelAppendReturnUrl){url=hyperLink;}else{try{url=AppendReturnUrl(hyperLink);}catch(e){url=hyperLink;}}return url;};function HL(anchor,excludeReturnUrl,openInNewWindow){anchor=GetElementById(anchor);if(anchor.href){return L(anchor.href,excludeReturnUrl,openInNewWindow);}return false;};function hl(anchor,excludeReturnUrl){anchor=GetElementById(anchor);if(anchor){var dataHref=anchor.getAttribute("data-href");if(dataHref==null||dataHref==""){dataHref=anchor.getAttribute("href");anchor.setAttribute("data-href",dataHref);}var hrefRtn=PI_HyperLinkConstruct_Private(dataHref);if(hrefRtn!=dataHref){anchor.href=hrefRtn;}}return true;};function CL(confirmMessage,scriptPath,excludeReturnUrl,excludeReturnUrlAlternate){if(confirm(confirmMessage)){return L(scriptPath,excludeReturnUrl,excludeReturnUrlAlternate);}return false;};function LI(scriptPath,id,optionalNameString,openInNewWindow){if(scriptPath.indexOf("?")>=0){scriptPath+="&";}else{scriptPath+="?";}if(!optionalNameString){optionalNameString="Id";}return L(scriptPath+optionalNameString+"="+id,false,openInNewWindow);};function ConfirmAndPostBack(confirmMessage,target,args){if(confirm(confirmMessage)){__doPostBack(target,args);}};function AppendReturnUrl(scriptPath,returnUrl){if(!returnUrl){returnUrl=ReturnUrl;}returnUrl=AppendScrollLocation(returnUrl);if(scriptPath.indexOf("?")>=0){scriptPath+="&";}else{scriptPath+="?";}scriptPath+="rtn="+encodeURIComponent(returnUrl);return scriptPath;};function AppendScrollLocation(returnUrl){var scrollX=GetElementById("__sx");var scrollY=GetElementById("__sy");if(scrollX&&scrollX.value!=""&&scrollX.value!="0"){if(returnUrl.indexOf("?")>=0){returnUrl+="&";}else{returnUrl+="?";}returnUrl+="_sx="+scrollX.value;}if(scrollY&&scrollY.value!=""&&scrollY.value!="0"){if(returnUrl.indexOf("?")>=0){returnUrl+="&";}else{returnUrl+="?";}returnUrl+="_sy="+scrollY.value;}if(AdditionalHiddenElementNamesToAppendToReturnUrl!=null){for(var i=0;i<AdditionalHiddenElementNamesToAppendToReturnUrl.length;i++){var elementName=AdditionalHiddenElementNamesToAppendToReturnUrl[i];var elementValue=FormTools.Get(elementName);if(elementValue&&elementValue!=""){if(returnUrl.indexOf("?")>=0){returnUrl+="&"}else{returnUrl+="?";}returnUrl+="_0"+elementName+"="+elementValue;}}}return returnUrl;};var OnLoad={aFunctions:[],AddFunction:function(oFunctionPointer){var oldonload=window.onload;if(typeof window.onload=='function'){window.onload=function(){oldonload();oFunctionPointer();}}else{window.onload=oFunctionPointer;}}};var OnScrollFunctions={aFunctions:[],AddFunction:function(oFunctionPointer){if(!this.Loaded){this.aFunctions[this.aFunctions.length]=oFunctionPointer;}else{oFunctionPointer();}},CallFunctions:function(){for(oFunctionPointer in this.aFunctions){this.aFunctions[oFunctionPointer]();}this.Loaded=true;},Loaded:false};window.onscroll=function(){OnScrollFunctions.CallFunctions();};var OnWindowResizeFunctions={aFunctions:[],AddFunction:function(oFunctionPointer){if(!this.Loaded){this.aFunctions[this.aFunctions.length]=oFunctionPointer;}else{oFunctionPointer();}},CallFunctions:function(){for(oFunctionPointer in this.aFunctions){this.aFunctions[oFunctionPointer]();}this.Loaded=true;},Loaded:false};function WindowResize(){OnWindowResizeFunctions.CallFunctions();};window.onresize=function(){OnWindowResizeFunctions.CallFunctions();};function GetElementById(elementId){if(typeof elementId=='string'){if(elementId==""){return null;}else{var element=document.getElementById(elementId)
if(!element){try{element=document.forms[0][elementId];}catch(ex){element=null;}if(element!=null){if(element.length==null&&element.id!=elementId&&element.name!=elementId){element=null;}}}return element;}}else{return elementId;}};function GetUrlParam(parameter){var sPageURL=decodeURIComponent(window.location.search.substring(1)),sURLVariables=sPageURL.split('&'),sParameterName,i;for(i=0;i<sURLVariables.length;i++){sParameterName=sURLVariables[i].split('=');if(sParameterName[0].toLowerCase()===parameter.toLowerCase()){return sParameterName[1]===undefined?true:sParameterName[1];}}return"";};function NewGuid(){var g="";for(var i=0;i<32;i++){var chr=Math.floor(Math.random()*0xF).toString(0xF);if(chr==null||chr==""||chr.length>1){chr+="0";}if(i==7||i==11||i==15||i==19){chr+="-";}g+=chr;}return g;};function IsEnterKey(localEvent){if(navigator.appName=="Netscape"&&parseInt(navigator.appVersion)>=4){if(localEvent.which){return(localEvent.which==13)}else{return false;}}else{if(!localEvent){localEvent=window.event;}return(localEvent.keyCode==13);}};function EKH(localEvent,element){if(IsEnterKey(localEvent)){FormTools.FocusAndClickElementUsingSetTimeout(element);return false;}return true;};var metafuseBaseShowHelpFromDelayShowHelp=null;function DSHlp(localEvent,helpText,helpWidth){if(!localEvent){return false;}if(helpText!=""){var x;var y;if(navigator.appName=="Netscape"&&parseInt(navigator.appVersion)>=4){x=localEvent.pageX;y=localEvent.pageY;}else{x=event.clientX+document.body.scrollLeft;y=event.clientY+document.body.scrollTop;}x=x+20;y=y+20;var timestamp=new Date().valueOf();metafuseBaseShowHelpFromDelayShowHelp=timestamp;setTimeout("MetafuseBase_ShowContextHelp("+x+","+y+",'"+helpText.split("'").join("\\'")+"',"+helpWidth+", '"+timestamp+"')",750);}};function SHlp(localEvent,helpText,helpWidth,offsetX,offsetY){if(helpText!=""){var x;var y;if(navigator.appName=="Netscape"&&parseInt(navigator.appVersion)>=4){x=localEvent.pageX;y=localEvent.pageY;}else{x=event.clientX+UITools.GetScrollLeft();y=event.clientY+UITools.GetScrollTop();}x=x+20;y=y+20;helpText=helpText.replace(/\\u0027/g,'\'')
MetafuseBase_ShowContextHelp(x,y,helpText,helpWidth);}};function MetafuseBase_ShowContextHelp(x,y,helpText,helpWidth,timestamp){if(timestamp!=null&&metafuseBaseShowHelpFromDelayShowHelp!=timestamp){return false;}if(helpText!=""){var contextHelp=GetElementById("ContextHelp_MetafuseBase_Div");if(contextHelp==null){InsertHTML('<div id="ContextHelp_MetafuseBase_Div" class="ContextHelp" style="position: absolute; z-index: 20000;display:none;width:300px;"></div>');contextHelp=GetElementById("ContextHelp_MetafuseBase_Div");}var helpHtml;if(helpWidth){helpHtml="<table style=\"width:"+helpWidth+"px;\"><tr><td>"+helpText+"</td></tr></table>";}else{helpHtml="<table><tr><td>"+helpText+"</td></tr></table>";}contextHelp.innerHTML=helpHtml;UITools.ShowAtXY(x,y,contextHelp,false,"fade");if(helpWidth==null||helpWidth<=0){if(contextHelp.firstChild.offsetWidth>=300){contextHelp.style.width=300+'px';var shim=UITools.GetElementShim("ContextHelp_MetafuseBase_Div");if(shim){shim.style.width=300+'px';}}else{contextHelp.style.width=contextHelp.firstChild.offsetWidth+'px';var shim=UITools.GetElementShim("ContextHelp_MetafuseBase_Div");if(shim){shim.style.width=contextHelp.firstChild.offsetWidth+'px';}}}else{contextHelp.style.width=contextHelp.firstChild.offsetWidth+'px';var shim=UITools.GetElementShim("ContextHelp_MetafuseBase_Div");if(shim){shim.style.width=contextHelp.firstChild.offsetWidth+'px';}}}return true;};function HHlp(){metafuseBaseShowHelpFromDelayShowHelp=null;var contextHelp=GetElementById("ContextHelp_MetafuseBase_Div");if(contextHelp){UITools.HideDivAndIFrame(GetElementById("ContextHelp_MetafuseBase_Div"),UITools.GetElementShim("ContextHelp_MetafuseBase_Div"));}};function isAlien(a){return isObject(a)&&typeof a.constructor!='function';};function isArray(a){return isObject(a)&&a.constructor==Array;};function isBoolean(a){return typeof a=='boolean';};function isFunction(a){return typeof a=='function';};function isNull(a){return typeof a=='object'&&!a;};function isNumber(a){return((typeof a=='number'||!isNaN(parseFloat(a)))&&isFinite(a));};function isObject(a){return((a!=null)&&typeof a=='object')||isFunction(a);};function isString(a){return typeof a=='string';};function isUndefined(a){return typeof a==='undefined';};function isNullOrUndefined(v){return isUndefined(v)||v!=null;};function isEmpty(o){var i,v;if(isObject(o)){for(i in o){v=o[i];if(isUndefined(v)&&isFunction(v)){return false;}}}return true;};function isNullOrEmpty(v){return v==null||(isString(v)&&v=="");};function isDefined(v){if(typeof(window[v.toString()])!="undefined"){return true;}return false;};function UpdateOuterHTML(elementId,outerHTML,insertElementIfNonExistent,outerElementId){var element=GetElementById(elementId);var outerElement=null;if(outerElementId){outerElement=GetElementById(outerElementId);if(outerElement){element=outerElement;}}if(element!=null){if(element.nodeName!=null&&element.nodeName=="TR"){alert("You cannot replace the outerHTML of a table row");}else{var $element=$(element);try{$element.replaceWith(outerHTML);}catch(e){alert("Unable to update the outer HTML for the element supplied "+elementId+".  The error message will be dumped");__Dump(e);}}}else if(insertElementIfNonExistent){UITools.InsertHTML(outerHTML);}};function AddEventHandlerToElement(element,eventName,eventMethod,useCapture){element=GetElementById(element);if(element){if(element.attachEvent){return element.attachEvent(eventName,eventMethod);}else if(element.addEventListener){if(useCapture==null){useCapture=false;}element.addEventListener(eventName.replace("on",""),eventMethod,useCapture);return true;}}return false;};function RemoveEventHandlerFromElement(element,eventName,eventMethod,useCapture){element=GetElementById(element);if(element){if(element.detachEvent){return element.detachEvent(eventName,eventMethod);}else if(element.removeEventListener){element.removeEventListener(eventName.replace("on",""),eventMethod,useCapture);return true;}}return false;};function MenuConfirmAndPostBack(confirmMessage,target,args){if(confirm(confirmMessage)){__doPostBack(target,args);}};function HOn(element,enableDynamicDisplay,arrayOfAdditionalRows){if(element){var element=GetElementById(element);if(element){var className=element.className;var jElementsToHide=null;var jElementsToShow=null;if(enableDynamicDisplay||enableDynamicDisplay==1){var jElement=$(element);if(arrayOfAdditionalRows){for(var i=0;i<arrayOfAdditionalRows.length;i++){var row=arrayOfAdditionalRows[i];jElement=jElement.add(GetElementById(row));}}jElementsToShow=jElement.find(".SOH");jElementsToHide=jElement.find(".HOH");if(jElementsToShow!=null){jElementsToShow.show();}if(jElementsToHide!=null){jElementsToHide.hide();}}if(element.onmouseout==null){element.onmouseout=function(){element.onmouseout=null;element.className=element.className.replace(/ RowHighlight/gi,"");element.className=element.className.replace(/ RowHighlightT/gi,"");element.className=element.className.replace(/ RowHighlightM/gi,"");element.className=element.className.replace(/ RowHighlightB/gi,"");if(jElementsToShow!=null){jElementsToShow.hide();}if(jElementsToHide!=null){jElementsToHide.show();}if(arrayOfAdditionalRows){for(var i=0;i<arrayOfAdditionalRows.length;i++){var row=GetElementById(arrayOfAdditionalRows[i]);if(row){row.onmouseout=null;row.className=row.className.replace(/ RowHighlight/gi,"");row.className=row.className.replace(/ RowHighlightT/gi,"");row.className=row.className.replace(/ RowHighlightM/gi,"");row.className=row.className.replace(/ RowHighlightB/gi,"");}}}};};if(element.className.indexOf(" RowHighlight")<0){element.className+=" RowHighlight";}if(arrayOfAdditionalRows){for(var i=0;i<arrayOfAdditionalRows.length;i++){var row=GetElementById(arrayOfAdditionalRows[i]);if(row){row.className+=" RowHighlight";if(row.onmouseout==null){row.onmouseout=element.onmouseout;}}}}}}};function HOnM(element,numberOfRowsBefore,numberOfRowsAfter){if((numberOfRowsBefore==null&&numberOfRowsAfter==null)||(numberOfRowsBefore==0&&numberOfRowsAfter==0)){HOn(element);}else{var className=element.className;var additionalRows=new Array();var additionalRowsClassName=new Array();var rowIndex=0;var previousSibling=GetPreviousSibling(element);var t=previousSibling.tagName;for(var i=1;i<=numberOfRowsBefore;i++){additionalRows[rowIndex]=previousSibling;additionalRowsClassName[rowIndex]=previousSibling.className;rowIndex++;previousSibling.className+=" RowHighlight";previousSibling=GetPreviousSibling(previousSibling);}var nextSibling=GetNextSibling(element);for(var k=1;k<=numberOfRowsAfter;k++){additionalRows[rowIndex]=nextSibling;additionalRowsClassName[rowIndex]=nextSibling.className;rowIndex++;nextSibling.className+=" RowHighlight";nextSibling=GetNextSibling(nextSibling);}if(element.onmouseout==null){element.onmouseout=function(){element.className=className;element.onmouseout=null;for(var j=0;j<rowIndex;j++){additionalRows[j].className=additionalRowsClassName[j];}};}element.className+=" RowHighlight";}};function GetPreviousSibling(element){if(element.previousSibling==null){return null;}if(element.previousSibling.nodeType==1){return element.previousSibling;}return GetPreviousSibling(element.previousSibling);};function GetNextSibling(element){if(element.nextSibling==null){return null;}if(element.nextSibling.nodeType==1){return element.nextSibling;}return GetNextSibling(element.nextSibling);};function UC(element,className){element=GetElementById(element);if(className==null){className="";}if(element){element.className=className;}};function HOf(element,className){UC(element,className);};function MathTools(){this.NumberDecimalDigits=2;this.NumberDecimalSeparator=".";this.NumberGroupSeparator=",";this.NumberGroupSizes=new Array("3");this.NumberNegativePattern="-n";this.DecimalExcludeCommas=false;this.DecimalExcludeLeadingZero=false;this.DecimalExcludeTrailingZeros=false;this.CurrencyDecimalDigits=2;this.CurrencyDecimalSeparator=".";this.CurrencyGroupSeparator=",";this.CurrencyGroupSizes=new Array("3");this.CurrencyNegativePattern="$-n";this.CurrencyPositivePattern="$n";this.CurrencyExcludeCommas=false;this.CurrencyExcludeLeadingZero=false;this.CurrencyExcludeTrailingZeros=false;this.PercentPositivePattern="n%";this.PercentNegativePattern="-n%";this.PercentExcludeLeadingZero=false;this.PercentExcludeTrailingZeros=false;this.WorkdaySecondsInDay=28800;this.SetFields=function(numberDecimalDigits,numberDecimalSeparator,numberGroupSeparator,numberGroupSizes,numberNegativePattern,currencyDecimalDigits,currencyDecimalSeparator,currencyGroupSeparator,currencyGroupSizes,currencyNegativePattern,currencyPositivePattern,percentNegativePattern,percentPositivePattern){this.NumberDecimalDigits=numberDecimalDigits;this.NumberDecimalSeparator=numberDecimalSeparator;this.NumberGroupSeparator=numberGroupSeparator;this.NumberGroupSizes=numberGroupSizes;this.NumberNegativePattern=numberNegativePattern;this.CurrencyDecimalDigits=currencyDecimalDigits;this.CurrencyDecimalSeparator=currencyDecimalSeparator;this.CurrencyGroupSeparator=currencyGroupSeparator;this.CurrencyGroupSizes=currencyGroupSizes;this.CurrencyNegativePattern=currencyNegativePattern;this.CurrencyPositivePattern=currencyPositivePattern;this.PercentNegativePattern=percentNegativePattern;this.PercentPositivePattern=percentPositivePattern;};this.IsNumeric=function(inputString){var sNumber;var fNumber;if(inputString!=null){sNumber=inputString.toString();fNumber=parseFloat(inputString);if(sNumber==fNumber&&fNumber!=Number.POSITIVE_INFINITY&&fNumber!=Number.NEGATIVE_INFINITY){return true;}}return false;};this.FormatDecimalString=function(stringValue,returnEmptyStringWhenNaN,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale,positiveOnly,numberDecimalSeparator,numberGroupSeparator,numberGroupSizes){if(excludeCommas==null){excludeCommas=this.DecimalExcludeCommas;}if(excludeLeadingZero==null){excludeLeadingZero=this.DecimalExcludeLeadingZero;}if(excludeTrailingZeros==null){excludeTrailingZeros=this.DecimalExcludeTrailingZeros;}if(scale==null){scale=this.NumberDecimalDigits;}if(numberDecimalSeparator==null||isBoolean(numberDecimalSeparator)){numberDecimalSeparator=this.NumberDecimalSeparator;}if(numberGroupSeparator==null){numberGroupSeparator=this.NumberGroupSeparator;}if(numberGroupSizes==null){numberGroupSizes=this.NumberGroupSizes;}var decimalValue=this.ParseFloat(stringValue,true,numberDecimalSeparator);if(decimalValue==null){if(returnEmptyStringWhenNaN){return"";}else{decimalValue=new Number(0);}}var dec=new Number(decimalValue);var decRounded=this.Round(dec,scale,numberDecimalSeparator);decRounded=new Number(decRounded);var decimalString=new String(decRounded.toString());if(decimalString.indexOf(".")<0){decimalString+=".";}var decimalStringArray=decimalString.split(".");var decimalLeftSide=new String(decimalStringArray[0]);var decimalRightSide=new String(decimalStringArray[1]);var isNegative=false;if(decimalValue<0){if(!positiveOnly){isNegative=true;}decimalLeftSide=decimalLeftSide.replace("-","");}if(scale>0&&Math.abs(decimalValue)<1){if(excludeLeadingZero){decimalLeftSide="";}else if(decimalLeftSide.length==0){decimalLeftSide="0";}}if(!excludeTrailingZeros&&scale>0&&decimalRightSide.length<scale){for(var i=decimalRightSide.length;i<scale;i++){decimalRightSide+="0";}}if(!excludeCommas){var str="";var groupSize=new Number(numberGroupSizes[0]);var lengthProcessed=decimalLeftSide.length;var groupSizeIndex=0;while(lengthProcessed>0){if(str!=""){str=numberGroupSeparator+str;}lengthProcessed-=groupSize;if(lengthProcessed<0){groupSize+=lengthProcessed;lengthProcessed=0;}else if(groupSize==0){groupSize=lengthProcessed;lengthProcessed=0;}str=decimalLeftSide.substr(lengthProcessed,groupSize)+str;groupSizeIndex+=1;if(numberGroupSizes.length>groupSizeIndex){groupSize=numberGroupSizes[groupSizeIndex];}}decimalLeftSide=str;}var returnDecimalString=new String(decimalLeftSide);if(decimalRightSide.length>0){returnDecimalString=decimalLeftSide+numberDecimalSeparator+decimalRightSide;}if(isNegative){return this.NumberNegativePattern.replace("n",returnDecimalString);}return returnDecimalString;};this.FormatCurrencyString=function(numberString,returnEmptyStringWhenNaN,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale,positiveOnly){if(excludeCommas==null){excludeCommas=this.CurrencyExcludeCommas;}if(excludeCommas==null){excludeCommas=this.CurrencyExcludeCommas;}if(excludeLeadingZero==null){excludeLeadingZero=this.CurrencyExcludeLeadingZero;}if(excludeTrailingZeros==null){excludeTrailingZeros=this.CurrencyExcludeTrailingZeros;}if(scale==null){scale=this.CurrencyDecimalDigits;}if(numberString==null){numberString="";}var numberStringTest=numberString.toString();var isNegative=false;if(!positiveOnly&&numberStringTest.indexOf("-")>=0||numberStringTest.indexOf("(")>=0||numberStringTest.indexOf(")")>=0){isNegative=true;}var decimalString=this.FormatDecimalString(numberString,returnEmptyStringWhenNaN,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale,true,this.CurrencyDecimalSeparator,this.CurrencyGroupSeparator,this.CurrencyGroupSizes);if(decimalString==""){return"";}if(isNegative){return this.CurrencyNegativePattern.replace("n",decimalString);}else{return this.CurrencyPositivePattern.replace("n",decimalString);}};this.FormatPercentString=function(stringValue,returnEmptyStringWhenNaN,excludeLeadingZero,excludeTrailingZeros,scale){if(excludeLeadingZero==null){excludeLeadingZero=this.PercentExcludeLeadingZero;}if(excludeTrailingZeros==null){excludeTrailingZeros=this.PercentExcludeTrailingZeros;}if(scale==null){scale=this.NumberDecimalDigits;}var decimalValue=this.ParseFloat(stringValue,true);var s=this.FormatDecimalString(decimalValue,returnEmptyStringWhenNaN,true,excludeLeadingZero,excludeTrailingZeros,scale,true);if(decimalValue<0){return this.PercentNegativePattern.replace("n",s);}else{return this.PercentPositivePattern.replace("n",s);}};this.FormatHoursAndMinutesString=function(stringValue,nearestMinutes,roundDirection){var hours=new Number(this.ParseHoursMinutesTimeToHoursDecimal(stringValue));var neg=false;if(hours<0){neg=true;hours=Math.abs(hours);}if(hours==0){return"00:00";}if(!isNullOrEmpty(roundDirection)&&roundDirection!=0&&roundDirection.toString().toLowerCase()!="none"){hours=this.RoundHoursToNearestMinutesMultiple(hours,nearestMinutes,roundDirection);}var h=Math.floor(hours);var minuteSecondFraction=Math.abs(hours)-Math.abs(h);var minutes=minuteSecondFraction*60;var m=Math.floor(minutes);var secondsFraction=Math.abs(minutes)-Math.abs(m);var s=this.Round(secondsFraction*60,0);if(s>=60){m+=1;}var hString="00";var mString="00";var sString="";if(h!=0){hString=h.toString();if(Math.abs(h)<10){hString="0"+hString;}}if(neg){hString="-"+hString;}if(m!=0){mString=m.toString();if(Math.abs(m)<10){mString="0"+mString;}}if(s>0&&s<60){sString=s.toString();if(Math.abs(s)<10){sString="0"+sString;}sString=":"+sString;}return hString+":"+mString+sString;};this.FormatHoursStringAndSetToInput=function(input,decimalValue,useHoursMinutes){input=GetElementById(input);if(input){if(useHoursMinutes||$(input).attr("data-pi-hours-minutes")=="1"){input.value=this.FormatHoursAndMinutesString(decimalValue);}else{input.value=this.FormatDecimalString(decimalValue);}}};this.ParseFloat=function(string,returnNullWhenNaN,numberDecimalSeparator){if(!isNumber(string)&&(string==null||string=="")){if(returnNullWhenNaN){return null;}else{return new Number(0);}}if(!isString(string)){var n=new Number(string);if(isNaN(n)){return new Number(0);}return n;}else{var stringInput=string.toString();if(numberDecimalSeparator==null||isBoolean(numberDecimalSeparator)){numberDecimalSeparator=this.NumberDecimalSeparator;}if(numberDecimalSeparator!="."){stringInput=stringInput.replace(/\./g,"");stringInput=stringInput.replace(numberDecimalSeparator,".");}var isNegative=false;if(stringInput.indexOf("-")>=0||stringInput.indexOf("(")>=0||stringInput.indexOf(")")>=0){isNegative=true;}var stripNotNumbers=/[^0-9.]/g;stringInput=stringInput.replace(stripNotNumbers,"");if(isNegative){stringInput="-"+stringInput;}var number=new Number(0);number=parseFloat(stringInput);if(number.toString()=="NaN"){if(returnNullWhenNaN){return null;}else{number=0;return new Number(number);}}else{return new Number(number);}}};this.ParseHoursMinutesTimeToHoursDecimal=function(string,returnNullWhenNaN){if(string!=null){var stringInput=string.toString();if(stringInput.indexOf(":")>=0){var timeArray=stringInput.split(":");var neg=false;if(stringInput.indexOf("-")>=0){neg=true;}var hr=0;var min=0;var sec=0;var hours=0;if(timeArray.length>0){hr=this.ParseFloat(timeArray[0],returnNullWhenNaN);}if(timeArray.length>1){min=this.ParseFloat(timeArray[1],returnNullWhenNaN);}if(timeArray.length>2){sec=this.ParseFloat(timeArray[2]);}if(returnNullWhenNaN&&hr==null&&min==null){return null;}else{if(hr!=null){hr=Math.abs(this.Round(hr,0));hours=hr;}if(min!=null){min=min/60;hours+=Math.abs(min);}if(sec!=null&&sec>0){sec=sec/3600;hours+=Math.abs(sec);}}if(neg){hours=0-hours;}return hours;}else{var hours=this.ParseFloat(string);return hours;}}if(returnNullWhenNaN){return null;}else{return 0;}};this.RoundHoursToNearestDecimalFractionSegment=function(hours,nearestFractionSegment,roundDirection){var rtn=hours;if(hours==null&&nearestFractionSegment==null&&nearestFractionSegment!=0&&isNullOrEmpty(roundDirection)&&roundDirection!=0){var h=Math.floor(hours);var minuteSecondFraction=Math.abs(hours)-Math.abs(h);var hundred=100;var whole=this.Round(minuteSecondFraction*hundred,0);var segment=this.Round(nearestFractionSegment*hundred,0);var value=this.RoundToNearestSegment(whole,segment,roundDirection);value=value/hundred;rtn=h+value;}return rtn;};this.RoundHoursToNearestMinutesMultiple=function(hours,nearestMinutes,roundDirection){var rtn=hours;if(hours!=null&&nearestMinutes!=null&&nearestMinutes!=0&&!isNullOrEmpty(roundDirection)&&roundDirection!=0){var h=Math.floor(hours);var minuteSecondFraction=Math.abs(hours)-Math.abs(h);var minutes=minuteSecondFraction*60;var m=Math.floor(minutes);var secondsFraction=Math.abs(minutes)-Math.abs(m);var s=this.Round(secondsFraction*60,0);if(s>30){m+=1;}var min=this.RoundToNearestSegment(m,nearestMinutes,roundDirection);var sixty=60;rtn=h+(min/sixty);}return rtn;};this.RoundToNearestSegment=function(n,nearestSegment,roundDirection){if(n==null||nearestSegment==null){return n;}if(isNullOrEmpty(roundDirection)){roundDirection=1;}var r=this.Round(this.ParseFloat(n),0);var value=r;var factor=this.Round(this.ParseFloat(nearestSegment),0);if(factor>0){if(roundDirection==1||roundDirection.toString().toLowerCase()=="closest"){r=this.Round((value/factor),0)*factor;}else if(roundDirection==2||roundDirection.toString().toLowerCase()=="up"){Math.Ceiling
r=Math.ceil((value/factor))*factor;}else if(roundDirection==3||RoundDirection.toString().toLowerCase()=="down"){r=Math.floor(value/factor)*factor;}}return r;};this.ParseBool=function(s){s=s.toLowerCase();if(s=="true"||s=="1"||s=="on"||s==FormTools.GlobalYes.toLowerCase()){return true;}return false;};this.Round=function(number,scale,numberDecimalSeparator){var inNum=number;var sign=1;if(inNum<0){sign=-1;}if(scale==null){scale=this.NumberDecimalDigits;}inNum=this.ParseFloat(inNum,false,numberDecimalSeparator);inNum=Math.abs(inNum);scale=parseInt(scale);var n=new Number(sign*Math.round(inNum*Math.pow(10,scale))/Math.pow(10,scale));return n;};this.IsEven=function(integer){return(1-(integer%2));};this.SecondsToHours=function(seconds,decimalPlaces){var hours=0;if(MathTools.IsNumeric(seconds)){hours=parseInt(seconds)/3600;return MathTools.Round(hours,decimalPlaces);}};this.SecondsToWorkDays=function(seconds,decimalPlaces,isElapsed){var days=0;var workdaySeconds=this.WorkdaySecondsInDay;if(isElapsed){workdaySeconds=86400;}if(MathTools.IsNumeric(seconds)){days=parseInt(seconds)/this.WorkdaySecondsInDay;return MathTools.Round(days,decimalPlaces);}};this.HoursToSeconds=function(hours){var seconds=0;if(MathTools.IsNumeric(hours)){seconds=hours*3600;return MathTools.Round(seconds,0);}};this.DurationStringToObject=function(durationString){var d=durationString;var o=new Object();if(d!=null&&d!=""){o["rawvalue"]=d;var da=null;var days=0;var hmseconds=null;var elapsed=false;if(d.indexOf("em")>=0){da=d.split("em");o["scale"]="em";elapsed=true;var month=MathTools.ParseFloat(da[0]);days=month*30;o["mainvalue"]=month;}else if(d.indexOf("m")>=0){da=d.split("m");o["scale"]="m";var month=MathTools.ParseFloat(da[0]);days=month*20;o["mainvalue"]=month;}else if(d.indexOf("ew")>=0){da=d.split("ew");o["scale"]="ew";elapsed=true;var week=MathTools.ParseFloat(da[0]);days=week*7;o["mainvalue"]=week;}else if(d.indexOf("w")>=0){da=d.split("w");o["scale"]="w";var week=MathTools.ParseFloat(da[0]);days=week*5;o["mainvalue"]=week;}else if(d.indexOf("ed")>=0){da=d.split("ed");o["scale"]="ed";elapsed=true;days=MathTools.ParseFloat(da[0]);o["mainvalue"]=days;}else if(d.indexOf("d")>=0){da=d.split("d");o["scale"]="d";days=MathTools.ParseFloat(da[0]);o["mainvalue"]=days;}else if(d.indexOf("eh")>=0){elapsed=true;da=d.split('eh');o["scale"]="eh";hmseconds=MathTools.HoursMinutesToSeconds(da[0]);o["mainstring"]=da[0];o["mainvalue"]=MathTools.ParseFloat(da[0]);}else if(d.indexOf("h")>=0){da=d.split('h');o["scale"]="h";hmseconds=MathTools.HoursMinutesToSeconds(da[0]);o["mainstring"]=da[0];o["mainvalue"]=MathTools.ParseFloat(da[0]);}else if(d.indexOf(":")>=0){o["mainvalue"]="";da=new Array(2);da[0]="";da[1]=d;if(d.indexOf("e")==d.length-1){elapsed=true;}}else{da=d.split(' ');o["scale"]="d";days=MathTools.ParseFloat(da[0]);o["mainvalue"]=days;}var seconds=0;seconds=hmseconds;seconds=seconds+MathTools.DaysToSeconds(days,elapsed);if(days>0||elapsed){o["mainstring"]=da[0];}if(elapsed){o["iselapsed"]=true;}if(da.length>1){var hmseconds=MathTools.HoursMinutesToSeconds(da[1]);if(hmseconds>0){seconds+=hmseconds;o["hourminutestring"]=MathTools.FormatHoursAndMinutesString(da[1]);if(elapsed){o["hourminutestring"]+="e";}}}o["totalseconds"]=seconds;}return o;};this.HoursToDurationObject=function(hours){var seconds=hours*3600;return MathTools.SecondsToDurationObject(seconds);};this.SecondsToDurationObject=function(seconds,isElapsed){var seconds=MathTools.Round(MathTools.ParseFloat(seconds),0);var hours=MathTools.ParseFloat(seconds/3600);var hoursInWorkday=this.WorkdaySecondsInDay/3600;var o=new	Object();o["totalseconds"]=seconds;if(isElapsed){}else{var days=MathTools.SecondsToWorkDays(seconds,20);if(MathTools.GetScale(days)<=2){o["mainvalue"]=days;o["scale"]="d";}else{if(MathTools.IsNumeric(days)){days=parseInt(days);}o["mainvalue"]=days;o["scale"]="d";var hm=MathTools.SecondsToHourMinuteString(seconds);o["hourminutestring"]=hm;}}return o;};this.FormatDurationStringFromObj=function(durationObject){var s="";var d=durationObject;if(d){var ms=d["mainstring"];if(ms==null){ms=d["mainvalue"];}var sc=d["scale"];var hm=d["hourminutestring"];if(ms!=null&&ms!=""){s=ms;if(sc!=null){s+=sc;}}if(hm!=null&&hm!=""){if(s.length>0){s+=" ";}s+=hm;}}return s;};this.SecondsToHours=function(seconds){var hours=0;if(MathTools.IsNumeric(seconds)){hours=seconds/3600;return MathTools.Round(hours);}};this.DaysToSeconds=function(days,isElapsed){var s=0;if(MathTools.IsNumeric(days)){days=MathTools.ParseFloat(days);if(isElapsed){s=days*86400;}else{s=days*this.WorkdaySecondsInDay;}}s=MathTools.Round(s,0);return s;};this.HoursMinutesToSeconds=function(hoursMinutes){if(hoursMinutes&&hoursMinutes!=""){hoursMinutesArray=hoursMinutes.split(":");var hours=hoursMinutesArray[0];var minutes=hoursMinutesArray[1];var seconds=0;if(MathTools.IsNumeric(hours)){seconds=seconds+(hours*3600);}else{var hoursFloat=MathTools.ParseFloat(hours);if(hoursFloat>0){seconds=seconds+(hours*3600);}}if(MathTools.IsNumeric(minutes)){seconds=seconds+(minutes*60);}else{var minutesFloat=MathTools.ParseFloat(minutes);if(minutesFloat>0){minutesFloat=MathTools.Round(minutesFloat,0);seconds=seconds+(minutesFloat*60);}}return seconds;}else{return 0;}};this.SecondsToHourMinuteString=function(seconds){if(MathTools.IsNumeric(seconds)){var remainingSeconds=seconds%WorkdaySeconds;var totalHours=MathTools.SecondsToHoursInt(remainingSeconds);var remainingMinutesSeconds=remainingSeconds%3600;var totalMinutes=Round((remainingMinutesSeconds/60),0);if(totalMinutes.toString().length<2){totalMinutes="0"+totalMinutes;}return totalHours+":"+totalMinutes;}else{return"";}};this.SecondsToHoursInt=function(seconds){var hours=0;if(MathTools.IsNumeric(seconds)){hours=seconds/3600;return parseInt(hours);}};this.GetScale=function(floatValue){floatValue=this.ParseFloat(floatValue);var n=new Number();if(floatValue==0){n=0;}else{var s=floatValue.toString();s=s.replace(",",".");var indexOfPeriod=s.indexOf(".");if(indexOfPeriod>=0){n=s.length-(indexOfPeriod+1);}else{n=0;}}return n;}};var MathTools=new MathTools();function UITools(){this.GlobalIsControlKeyDown=false;this.GlobalIsShiftKeyDown=false;this.GlobalOK="OK";this.GlobalCancel="Cancel";this.IsDevelopmentMode=false;this.GetAttr=function(element,attributeName){var v="";element=GetElementById(element);if(element!=null){v=$(element).attr(attributeName);}return v;};this.SetAttr=function(element,attributeName,attributeValue){element=GetElementById(element);if(element!=null){$(element).attr(attributeName,attributeValue);return true;}return false;};this.GetPageXCoordinate=function(element){var elementId=element;element=GetElementById(element);if(element){var offsetParent=element;if(!offsetParent){alert("Able to find element, but unable to find the offsetParent for the element supplied to UITools.GetPageXCoordinate.  The next alert will dump the object");__Dump(element);}var offsetLeft=0;while(offsetParent!=null&&offsetParent.tagName!="BODY"&&offsetParent.tagName!="HTML"){offsetLeft+=offsetParent.offsetLeft-offsetParent.scrollLeft;if(offsetParent.parentNode&&offsetParent.parentNode!=offsetParent.offsetParent&&offsetParent.parentNode.scrollLeft&&offsetParent.parentNode.scrollLeft>0){offsetLeft-=offsetParent.parentNode.scrollLeft;}var newOffsetParent=offsetParent.offsetParent;if(newOffsetParent==null){newOffsetParent=offsetParent.parentNode;}offsetParent=newOffsetParent;}return parseInt(offsetLeft);}else{alert("Unable to locate the element supplied to the UITools.GetPageXCoordinate");__Dump(elementId);}};this.GetPageYCoordinate=function(element){var elementId=element;element=GetElementById(element);if(element){var offsetTop=0;var offsetParent=element;if(offsetParent.offsetTop==0&&offsetParent.tagName=="TR"&&BrowserTools.IsSafari()&&offsetParent.firstChild!=null){offsetParent=offsetParent.firstChild;}if(!offsetParent){alert("Able to find element, but unable to find the offsetParent for the element supplied to UITools.GetPageYCoordinate.  The next alert will dump the object");__Dump(element);}while(offsetParent!=null&&offsetParent.tagName!="BODY"&&offsetParent.tagName!="HTML"){offsetTop+=offsetParent.offsetTop-offsetParent.scrollTop;if(offsetParent.parentNode&&offsetParent.parentNode!=offsetParent.offsetParent&&offsetParent.parentNode.scrollTop&&offsetParent.parentNode.scrollTop>0){offsetTop-=offsetParent.parentNode.scrollTop;}var newOffsetParent=offsetParent.offsetParent;if(newOffsetParent==null){newOffsetParent=offsetParent.parentNode;}offsetParent=newOffsetParent;}return parseInt(offsetTop);}else{alert("Unable to locate the element supplied to the UITools.GetPageYCoordinate");__Dump(elementId);}};this.GetEventPageXCoordinate=function(localEvent){var x;if(navigator.appName=="Netscape"){x=parseInt(localEvent.pageX);}else{x=parseInt(localEvent.clientX+UITools.GetScrollLeft());}return x;};this.GetEventPageYCoordinate=function(localEvent){var y;if(navigator.appName=="Netscape"){y=parseInt(localEvent.pageY);}else{y=parseInt(localEvent.clientY+UITools.GetScrollTop());}return y;};this.GetWindowHeight=function(){if(BrowserTools.IsSafari()){return parseInt(window.innerHeight);}else{var h=parseInt(document.documentElement.clientHeight);if(h==null||h<=0){h=document.body.clientHeight;}return h;}};this.GetWindowWidth=function(){if(BrowserTools.IsSafari()){return parseInt(window.innerWidth);}else{var w=parseInt(document.documentElement.clientWidth);if(w==null||w<=0){w=parseInt(document.body.clientWidth);}return w;}};this.GetScrollLeft=function(){if(navigator.appName=="Netscape"){return parseInt(window.pageXOffset);}else{var scrollLeft=document.body.scrollLeft;var scrollLeftDocElement=0;if(document.documentElement!=null){scrollLeftDocElement=document.documentElement.scrollLeft;}return parseInt(Math.max(scrollLeft,scrollLeftDocElement));}};this.GetScrollTop=function(){if(navigator.appName=="Netscape"){return parseInt(window.pageYOffset);}else{var scrollTop=document.body.scrollTop;var scrollTopDocElement=0;if(document.documentElement!=null){scrollTopDocElement=document.documentElement.scrollTop;}return parseInt(Math.max(scrollTop,scrollTopDocElement));}};this.GetElementWidth=function(element){element=GetElementById(element);if(element==document){return $(document).width();}else if(element){return parseInt(element.offsetWidth);}else{alert("Unable to locate the element supplied to the UITools.GetElementWidth - 0 returned");}return 0;};this.GetElementHeight=function(element){element=GetElementById(element);if(element==document){return $(document).height();}else if(element){return parseInt(element.offsetHeight);}else{alert("Unable to locate the element supplied to the UITools.GetElementHeight - 0 returned");}return 0;};this.Show=function(elementId,effect){this.ToggleDisplay(elementId,false,effect);};this.SlideUp=function(elementId){var el=GetElementById(elementId);if(el!=null){$(el).slideUp();}};this.AddClass=function(elementId,className){var el=GetElementById(elementId);if(el!=null){$(el).addClass(className);}};this.RemoveClass=function(elementId,className){var el=GetElementById(elementId);if(el!=null){$(el).removeClass(className);}};this.SlideDown=function(elementId){var el=GetElementById(elementId);if(el!=null){$(el).slideDown();}};this.ShowAtEvent=function(localEvent,el,showVeil,effect,oX,oY){if(!localEvent){return false;}var x;var y;if(navigator.appName=="Netscape"&&parseInt(navigator.appVersion)>=4){x=localEvent.pageX;y=localEvent.pageY;}else{x=event.clientX+UITools.GetScrollLeft();y=event.clientY+UITools.GetScrollTop();}return this.ShowAtXY(x,y,el,showVeil,effect,oX,oY);};this.ShowDivAndIFrameAtEvent=function(localEvent,el,iframe,oX,oY){return this.ShowAtEvent(localEvent,el,false,null,oX,oY)};this.ShowPopupWindowAtCenterScreen=function(url,title,width,height,hideScrollbars,windowMessageEventHandler){var dualScreenLeft=window.screenLeft!=undefined?window.screenLeft:screen.left;var dualScreenTop=window.screenTop!=undefined?window.screenTop:screen.top;var screenWidth=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;var screenHeight=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;var left=((screenWidth/2)-(width/2))+dualScreenLeft;var top=((screenHeight/2)-(height/2))+dualScreenTop;var newWindow=window.open(url,title,'scrollbars='+(hideScrollbars?'0':'1')+', width='+width+', height='+height+', top='+top+', left='+left);if(windowMessageEventHandler){window.addEventListener("message",windowMessageEventHandler,false);}if(window.focus){newWindow.focus();}};this.ShowAtCenterScreen=function(el,showVeil,effect,oX,oY,isStrechable){var isStrechable=isStrechable||false;var el=GetElementById(el);if(el==null){return;}var x=0;var y=0;if(el.parentNode.tagName!="BODY"&&el.parentNode.tagName!="FORM"){el.parentNode.removeChild(el);document.forms[0].appendChild(el);}el.style.display="block";el.style.visibility="visible";var w=el.offsetWidth;var h=el.offsetHeight;el.style.display="none";el.style.visibility="";var wW=UITools.GetWindowWidth();var wH=UITools.GetWindowHeight();if(wW>w){x=(wW-w)/2;}x=x+UITools.GetScrollLeft();if(wH>h){y=(wH-h)/2;}y=y+UITools.GetScrollTop();return this.ShowAtXY(x,y,el,showVeil,effect,oX,oY,null,null,isStrechable);};this.ShowDivAndIFrameAtCenterScreen=function(el,d,oX,oY,showVeil){return this.ShowAtCenterScreen(el,showVeil,null,oX,oY);};this.ShowAtElement=function(elementNear,el,showVeil,oX,oY,outofWindowAllowed,scrollToKeepInWindow){return this.ShowAtXY(this.GetPageXCoordinate(elementNear),this.GetPageYCoordinate(elementNear),el,showVeil,null,oX,oY,outofWindowAllowed,scrollToKeepInWindow);};this.ShowDivAndIFrameAtElement=function(elementNear,el,f,oX,oY,showVeil,outofWindowAllowed,scrollToKeepInWindow){return this.ShowAtElement(elementNear,el,showVeil,oX,oY,outofWindowAllowed,scrollToKeepInWindow)};this.ShowAtXY=function(x,y,el,showVeil,effect,oX,oY,outofWindowAllowed,scrollToKeepInWindow,isStrechable){el=GetElementById(el);var iframe=null;if(el){if(el.parentNode.tagName!="BODY"&&el.parentNode.tagName!="FORM"){el.parentNode.removeChild(el);document.forms[0].appendChild(el);}if(effect){$(el).show(effect);}else{el.style.display="block";el.style.visibility="visible";}oX=MathTools.ParseFloat(oX);oY=MathTools.ParseFloat(oY);x=x+oX;y=y+oY;if(!outofWindowAllowed){if(scrollToKeepInWindow){var sX=this.GetPageXScrollByForAdjustedElementWithinWindow(x,el);var sY=this.GetPageYScrollByForAdjustedElementWithinWindow(y,el);if(sX!=0||sY!=0){window.scrollBy(sX,sY);}}else{var x=this.GetPageXCoordinateAdjustedElementWithinWindow(x,el);var y=this.GetPageYCoordinateAdjustedElementWithinWindow(y,el);}}el.style.left=x+"px";el.style.top=y+"px";var f=UITools.GetElementShim(el);if(isStrechable){$(el).resizable({minWidth:$('#'+el.id).width(),minHeight:$('#'+el.id).height(),alsoResize:'#'+el.id+'_Body'});}if(f!=null){this.ShowIFrameUnderDiv(el,f,x,y);}if(showVeil){metafuseVeil.ShowVeilUnderElement(el,f);}}else{alert("Unable to locate the element specified in the UITools.ShowAtXY function");}return false;};this.ShowDivAndIFrameAtXY=function(x,y,el,f,oX,oY,showVeil,outofWindowAllowed,scrollToKeepInWindow){return this.ShowAtXY(x,y,el,showVeil,null,oX,oY,outofWindowAllowed,scrollToKeepInWindow);};this.ShowIFrameUnderDiv=function(el,f,x,y){el=GetElementById(el);f=GetElementById(f);if(el&&f){f.display="";f.style.width=el.offsetWidth+'px';f.style.height=el.offsetHeight+'px';if(el.onresize==null){el.onresize=function(){f.style.width=el.offsetWidth+'px';f.style.height=el.offsetHeight+'px';};}if(y==null){y=this.GetPageYCoordinate(el);}if(x==null){x=this.GetPageXCoordinate(el);}f.style.top=y+"px";f.style.left=x+"px";if(el.style.zIndex){f.style.zIndex=el.style.zIndex-1;}f.style.display="";}else{alert("Unable to locate either the element or the div at specified in the UITools.ShowIFrameUnderDiv function");}};this.EnsureElementAndIFrameDisplayedWithinWindow=function(element,scrollToKeepInWindow){element=GetElementById(element);if(element){var x=this.GetPageXCoordinate(element);var y=this.GetPageYCoordinate(element);if(scrollToKeepInWindow&&isBoolean(scrollToKeepInWindow)){var sX=this.GetPageXScrollByForAdjustedElementWithinWindow(x,element);var sY=this.GetPageYScrollByForAdjustedElementWithinWindow(y,element);if(sX!=0||sY!=0){window.scrollBy(sX,sY);}}else{var xC=this.GetPageXCoordinateAdjustedElementWithinWindow(x,element);var yC=this.GetPageYCoordinateAdjustedElementWithinWindow(y,element);if(x!=xC){element.style.left=xC+"px";}if(y!=yC){element.style.top=yC+"px";}var iframe=this.GetElementShim(element);if(iframe){iframe.style.width=element.offsetWidth+'px';iframe.style.height=element.offsetHeight+'px';if(x!=xC){iframe.style.left=xC+"px";}if(y!=yC){iframe.style.top=yC+"px";}}}}};this.GetPageXCoordinateAdjustedElementWithinWindow=function(x,element){var scrollLeft=UITools.GetScrollLeft();var windowWidth=UITools.GetWindowWidth();var xOver=(x+element.offsetWidth)-(windowWidth+scrollLeft);if(xOver>0){x=x-xOver;}if(x<scrollLeft){x=scrollLeft;}return x;};this.GetPageYCoordinateAdjustedElementWithinWindow=function(y,element){var scrollTop=UITools.GetScrollTop();var windowHeight=UITools.GetWindowHeight();var yOver=(y+element.offsetHeight)-(windowHeight+scrollTop);if(yOver>0){y=y-yOver;}if(y<scrollTop){y=scrollTop;}return y;};this.GetPageXScrollByForAdjustedElementWithinWindow=function(x,element){var scrollLeft=UITools.GetScrollLeft();var windowWidth=UITools.GetWindowWidth();var xOver=(x+element.offsetWidth)-(windowWidth+scrollLeft);if(xOver>0){return xOver;}if(x<scrollLeft){return xOver;}return 0;};this.GetPageYScrollByForAdjustedElementWithinWindow=function(y,element){var scrollTop=UITools.GetScrollTop();var windowHeight=UITools.GetWindowHeight();var yOver=(y+element.offsetHeight)-(windowHeight+scrollTop);if(yOver>0){return yOver;}if(y<scrollTop){return yOver;}return 0;};this.Hide=function(id,effect){var el=GetElementById(id);if(el){if(effect){$(el).hide(effect);}else{el.style.display="none";}}metafuseVeil.HideVeilUnderElement(el);};this.HideDivAndIFrame=function(id,f){this.Hide(id);};this.GetIFrameForShim=function(iframeId){var iframe=GetElementById(iframeId);if(iframe==null){this.InsertHTML("<iframe id=\""+iframeId+"\" scrolling=\"no\" frameborder=\"0\" style=\"position:absolute;top:0px; left:0px; display:none;color:#ffffff;font-size:1px;\"></iframe>");iframe=GetElementById(iframeId);}return iframe;};this.AlwaysCreateShim=false;this.GetElementShim=function(element){if((BrowserTools.IsInternetExplorer()&&BrowserTools.GetMajorVersion()<9)||this.AlwaysCreateShim){element=GetElementById(element);if(element!=null){return UITools.GetIFrameForShim(element.id+"_Shim_erspw");}}return null;};this.FocusOnElement=function(elementToFocus){var focusElement=GetElementById(elementToFocus);if(focusElement){if(focusElement.style){if(focusElement.style.display!="none"){try{focusElement.focus();}catch(e){}}}}};this.ClickElement=function(element){element=GetElementById(element);if(element){if(BrowserTools.IsInternetExplorer()||BrowserTools.IsSafari()){element.click();}else{var evt=document.createEvent('MouseEvents');try{evt.initMouseEvent('click',true,true,document.defaultView,1,0,0,0,0,false,false,false,false,0,null);element.dispatchEvent(evt);}catch(ex){try{element.click();}catch(ex2){};};}}};this.DisableElement=function(elementNameToDisable){this.ToggleElementDisable(elementNameToDisable,false);};this.EnableElement=function(elementNameToEnable){ToggleElementDisable(elementNameToEnable,true);};this.ToggleElementDisable=function(elementName,enable){var element=GetElementById(elementName);if(element){if(enable){if(element.tagName=="A"&&(BrowserTools.IsInternetExplorer()==false||isUndefined(element.disabled)==true)){var href_previous=element.getAttribute("href_previous");if(href_previous&&href_previous!=null&&href_previous!=""){element.setAttribute("href",href_previous);}var onclick_previous=element.getAttribute("onclick_previous");if(onclick_previous&&onclick_previous!=null&&onclick_previous!=""){element.setAttribute("onclick",onclick_previous);}var onmousedown_previous=element.getAttribute("onmousedown_previous");if(onmousedown_previous&&onmousedown_previous!=null&&onmousedown_previous!=""){element.setAttribute("onmousedown",onmousedown_previous);}var onmouseover_previous=element.getAttribute("onmouseover_previous");if(onmouseover_previous&&onmouseover_previous!=null&&onmouseover_previous!=""){element.setAttribute("onmouseover",onmouseover_previous);}var color_previous=element.getAttribute("color_previous");if(color_previous&&color_previous!=null&&color_previous!=""){element.style.color=color_previous;}else{element.style.color="";}}else{if(element.tagName=="TABLE"&&element.className=="MetafuseComboBox"){element.disabled=false;$(element).removeAttr('disabled');var textBox=GetElementById(element.id+'_tb');if(textBox){textBox.disabled=false;$(textBox).removeAttr('disabled');}}else if(isUndefined(element.disabled)==false){element.disabled=false;$(element).removeAttr('disabled');var popupCalendar=GetElementById(element.id+"_PU_TG");if(popupCalendar!=null&&popupCalendar.tagName=="IMG"){$(popupCalendar).off("click",false);}}}}else{if(element.tagName=="A"&&(BrowserTools.IsInternetExplorer()==false||isUndefined(element.disabled)==true)){var href=element.getAttribute("href");if(href&&href!=null&&href!=""){element.setAttribute("href_previous",href);element.setAttribute("href","javascript:;");}var onclick=element.getAttribute("onclick");if(onclick&&onclick!=null&&onclick!=""){element.setAttribute("onclick_previous",onclick);element.setAttribute("onclick","void(0);");}var onmousedown=element.getAttribute("onmousedown");if(onmousedown&&onmousedown!=null&&onmousedown!=""){element.setAttribute("onmousedown_previous",onmousedown);element.setAttribute("onmousedown","return false;");}var onmouseover=element.getAttribute("onmouseover");if(onmouseover&&onmouseover!=null&&onmouseover!=""){element.setAttribute("onmouseover_previous",onmouseover);element.setAttribute("onmouseover","return false;");}if(element.style.color){element.setAttribute("color_previous",element.style.color);}element.style.color="gray";}else{if(element.tagName=="TABLE"&&element.className=="MetafuseComboBox"){element.disabled=false;$(element).removeAttr('disabled');var textBox=GetElementById(element.id+'_tb');if(textBox){$(textBox).attr('disabled','disabled');textBox.disabled=true;}}else if(isUndefined(element.disabled)==false){$(element).attr('disabled','disabled');element.disabled=true;var popupCalendar=GetElementById(element.id+"_PU_TG");if(popupCalendar!=null&&popupCalendar.tagName=="IMG"){$(popupCalendar).on("click",false);}}}}}};this.ToggleDisplay=function(element,hide,effect,effectOptions,effectTiming){if(isArray(element)){for(var i=0;i<element.length;i++){this.ToggleDisplay(element[i],hide,effect,effectOptions,effectTiming);}return false;}element=GetElementById(element);if(element){if(hide){if(element.style.display!="none"){if(effect!=null){if(effectTiming==null){effectTiming=200;}$(element).toggle(effect,effectOptions,effectTiming);}else{element.style.display="none";}}}else{if(element.style.display=="none"){if(effect!=null){if(effectTiming==null){effectTiming=200;}$(element).toggle(effect,effectOptions,effectTiming);}else{element.style.display="";}}}if(element.type!=null&&element.type=="checkbox"&&element.nextSibling&&element.nextSibling.tagName=="LABEL"){UITools.ToggleDisplay(element.nextSibling,hide);}}return false;};this.Toggle=function(element,effect,effectOptions,effectTiming){if(isArray(element)){for(var i=0;i<element.length;i++){this.Toggle(element[i],effect,effectOptions,effectTiming);}return false;}element=GetElementById(element);$(element).toggle(effect,effectOptions,effectTiming);if(element.type!=null&&element.type=="checkbox"&&element.nextSibling&&element.nextSibling.tagName=="LABEL"){this.Toggle(element.nextSibling,effect,effectOptions,effectTiming);}return false;};this.GetKeyDown=function(localEvent){var keyCode=document.layers?localEvent.which:document.all?event.keyCode:document.getElementById?localEvent.keyCode:0;return keyCode;};this.GetKeyUp=function(localEvent){var keyCode=document.layers?localEvent.which:document.all?event.keyCode:document.getElementById?localEvent.keyCode:0;return keyCode;};this.InsertHTML=function(html){if(html!=null&&html!=""){if(document.body&&document.body.insertAdjacentHTML){document.forms[0].insertAdjacentHTML('BeforeEnd',html);}else if(document.createRange){var range=document.createRange();if(range.createContextualFragment){range.selectNodeContents(document.body);var docFrag=range.createContextualFragment(html);document.forms[0].appendChild(docFrag);}}else if(document.layers){var layer=new Layer(window.innerWidth);layer.document.open();layer.document.write(html);layer.document.close();layer.top=document.height;document.height+=layer.document.height;layer.visibility='show';}}};this.UpdateInnerHTML=function(element,html){element=GetElementById(element);if(element){element.innerHTML=html;}};this.UpdateOuterHTML=function(elementId,html,insertElementIfNonExistent,outerElementId){UpdateOuterHTML(elementId,html,insertElementIfNonExistent,outerElementId);};this.UpdateTitleHTML=function(element,html){element=GetElementById(element);if(element){element.title=html;}};this.RemoveElementFromDOM=function(element){element=GetElementById(element);if(element){$(element).remove();}};this.CancelBubble=function(localEvent){if(localEvent==null&&window.event){localEvent=window.event;}if(localEvent){localEvent.cancelBubble=true;localEvent.returnValue=false;if(localEvent.stopPropagation){this
localEvent.stopPropagation();localEvent.preventDefault();}}return false;};this.DragElement=function(localEvent,elementId){var element=GetElementById(elementId);if(localEvent.button){if(localEvent.button!="1"){return;}}else if(localEvent.which){if(localEvent.which!="1"){return;}}if(element.parentNode.tagName!="BODY"&&element.parentNode.tagName!="FORM"){this.ShowDivAndIFrameAtElement(element,element);element.parentNode.removeChild(element);document.forms[0].appendChild(element);}var dragObject=new MetafuseGenericDragObject();dragObject.StartDrag(localEvent,GetElementById(elementId));return false;};this.GetParentNodeByTagName=function(elementId,tagName){var element=GetElementById(elementId);var parentNode=element;while(parentNode!=null){if(parentNode.nodeName!=null&&parentNode.nodeName==tagName){return parentNode;}parentNode=parentNode.parentNode;}return null;};this.GetChildNodeByTagName=function(elementId,tagName){var element=GetElementById(elementId);if(element.nodeName==tagName){return element;}for(var i=0;i<element.childNodes.length;i++){var childNode=element.childNodes[i];if(childNode.nodeName!=null&&childNode.nodeName==tagName){return childNode;}}for(var i=0;i<element.childNodes.length;i++){var childNode=element.childNodes[i];var matchingNode=UITools.GetChildNodeByTagName(childNode,tagName);if(matchingNode!=null){return matchingNode;}}return null;};this.MoveElement=function(element,newParentNode){element=GetElementById(element);newParentNode=GetElementById(newParentNode);if(element&&newParentNode){if(element.parentNode!=newParentNode){element.parentNode.removeChild(element);newParentNode.appendChild(element);}}};this.EnableResize=function(element){var element=GetElementById(element);if(element){$(element).resizable({handles:"se"});}};this.TruncateLeft=function(value,maxLength){if(value!=null&&value.length>maxLength){value=value.substr(value,maxLength)+"...";}return value;};this.Alert=function(message,title,excludeVeil,width,effect,confirmJSCode,confirmBtnText,confirmJSCode2,confirmBtnText2,confirmJSCode3,confirmBtnText3,additionalJSOnCancel,disableCancel,hideCloseWindowIcon){this.ShowAlertBox(message,title,excludeVeil,width,effect,confirmJSCode,confirmBtnText,confirmJSCode2,confirmBtnText2,confirmJSCode3,confirmBtnText3,additionalJSOnCancel,disableCancel,hideCloseWindowIcon);};this.ShowAlertBox=function(message,title,excludeVeil,width,effect,confirmJSCode,confirmBtnText,confirmJSCode2,confirmBtnText2,confirmJSCode3,confirmBtnText3,additionalJSOnCancel,disableCancel,hideCloseWindowIcon){message=FormTools.FormatApiResponseErrorList(message);var id="metafuseAlertBox_"+new Date().valueOf().toString();var defaultAlert=GetElementById(id);var insertHTML=true;var idTitle=id+"_title";var idBody=id+"_body";var tableWidthString="";var cellWidthString="";if(width){tableWidthString='width:'+width+'px;';cellWidthString=' style="'+tableWidthString+'"';}else{}if(!message){message="";}if(!title){title="";}var addCancel=false;if(confirmJSCode!=null&&confirmJSCode!=""){confirmJSCode+=";";addCancel=true;}else{confirmJSCode="";}if(confirmBtnText==null||confirmBtnText==""){confirmBtnText=this.GlobalOK;}if(confirmBtnText2==null||confirmBtnText2==""){confirmBtnText2=this.GlobalOK;}if(confirmBtnText3==null||confirmBtnText3==""){confirmBtnText3=this.GlobalOK;}var boxHTML='<table id="'+id+'" class="DraggableLayer" style="display:none;z-Index:36000;'+tableWidthString+'"><tr onmousedown="UITools.DragElement(event, \''+id+'\');"><th id="'+id+'_title" class="DraggableLayer">'+title+'</th><th class="DraggableLayer AR">';if(additionalJSOnCancel==null){additionalJSOnCancel="";}else{addCancel=true;}if(confirmBtnText!="disabled"&&!hideCloseWindowIcon){boxHTML+='<a href="javascript:;" onmousedown="UITools.CancelBubble(event);" class=\"DraggableLayerClose\" onclick="UITools.HideAlertBox(\''+id+'\');'+additionalJSOnCancel+'"><img src="'+Root+'/i/c.gif" alt="" class="VM"/></a>';}boxHTML+='</th></tr><tr><td id="'+id+'_body" colspan="2" class="DraggableLayer VVLG"'+cellWidthString+'>'+message+'</td></tr><tr><td class="DraggableLayer AR" colspan="2">';if(confirmBtnText!="disabled"&&confirmBtnText!="disabled-leave-close"){boxHTML+='<a id=\'confirm_'+id+'\' onkeydown=\"return EKH(event, \'confirm_'+id+'\');\" class="Button mR10 mL5" style="margin-right:10px;" href="javascript:;" onclick="'+confirmJSCode+'UITools.HideAlertBox(\''+id+'\');">'+confirmBtnText+'</a>';}if(confirmJSCode2!=null&&confirmJSCode2!=""){boxHTML+='<a class="Button mR10 mL5" href="javascript:;" onclick="'+confirmJSCode2+'UITools.HideAlertBox(\''+id+'\');">'+confirmBtnText2+'</a>';addCancel=true;}if(confirmJSCode3!=null&&confirmJSCode3!=""){boxHTML+='<a class="Button mR10 mL5" href="javascript:;" onclick="'+confirmJSCode3+'UITools.HideAlertBox(\''+id+'\');">'+confirmBtnText3+'</a>';addCancel=true;}if(addCancel&&!disableCancel){boxHTML+='<a class="mR10 mL5" href="javascript:;" onclick="'+additionalJSOnCancel+';return UITools.HideAlertBox(\''+id+'\');">'+this.GlobalCancel+'</a>';}boxHTML+='</td></tr></table>';var $pageForm=$('form');if($pageForm.length){$pageForm.first().append(boxHTML);}else{$('body').append(boxHTML);}this.ShowAtCenterScreen(id,!excludeVeil,effect);this.FocusOnElement('confirm_'+id);return GetElementById(id);};this.HideAlertBox=function(id){id=GetElementById(id);this.Hide(id);var el=GetElementById(id);if(el!=null){$(el).remove();}return false;};this.LoadMetafuseIFrame=function(elementId){var element=GetElementById(elementId);if(element!=null){var $element=$(element);var src=$element.attr("src");if(isUndefined(src)||src==""||src!=null){var framesrc=$element.attr("data-iframe-src");var frameHeight=$element.attr("data-iframe-height");var iframe=document.createElement("iframe");iframe.setAttribute("id",elementId+"_frame");if(!isUndefined(framesrc)&&framesrc!=""&&framesrc!=null){$element.attr("data-iframe-src","")
iframe.setAttribute("src",framesrc);iframe.setAttribute("frameborder","0");iframe.setAttribute("class","W100");if(!isUndefined(frameHeight)){iframe.setAttribute("height",frameHeight);}$(element).empty();element.appendChild(iframe);}}}};this.InitializeMetafuseIFrames=function(){var $iframes=$("[data-iframe-src]");$iframes.each(function(index,element){var $element=$(element);var id=$element.attr("id");if(!isUndefined(id)&&id!=""&&id!=null){UITools.LoadMetafuseIFrame(id);}});};this.ModDom=function(){var modDom=GetElementById("__modDomSpan");if(modDom==null){$("body").append("<span id=\"__modDomSpan\" style=\"height:0px;line-height:0px;display:none;\"></span>");modDom=GetElementById("__modDomSpan");};modDom.style.display="block";modDom.style.display="none";};this.GetPIAttr=function(elementId,attribute){var element=GetElementById(elementId);if(element&&attribute!=null&&attribute!=""){if(attribute.toLowerCase().indexOf("data-pi-")<0){attribute="data-pi-"+attribute;}var att=$(element).attr(attribute);if(att){return att;}}return"";};this.SetPIAttr=function(elementId,attribute,value){var element=GetElementById(elementId);if(element&&attribute!=null&&attribute!=""){if(attribute.toLowerCase().indexOf("data-pi-")<0){attribute="data-pi-"+attribute;}$(element).attr(attribute,value);}};};var UITools=new UITools();function GlobalF1KeyInvokeContextHelp(){};function GlobalKeyDown(event){var keyCode=UITools.GetKeyDown(event);if(keyCode==112){GlobalF1KeyInvokeContextHelp();return UITools.CancelBubble(event);}if(keyCode==16){UITools.GlobalIsShiftKeyDown=true;}if(keyCode==17){UITools.GlobalIsControlKeyDown=true;}};function GlobalKeyUp(event){var keyCode=UITools.GetKeyUp(event);if(keyCode==16){UITools.GlobalIsShiftKeyDown=false;}if(keyCode==17){metafuseGlobalLinkOpenInNewWindow=false;UITools.GlobalIsControlKeyDown=false;}};function GlobalAddKeyDownAndKeyUpEventsToDocument(){AddEventHandlerToElement(document,"onkeydown",GlobalKeyDown,false);AddEventHandlerToElement(document,"onkeyup",GlobalKeyUp,false);window.onhelp=function(event){return UITools.CancelBubble(event);};};OnLoad.AddFunction(GlobalAddKeyDownAndKeyUpEventsToDocument);function FormTools(){this.GlobalYes="Yes";this.GlobalNo="No";this.UpdateSelectOptions=function(selectClientID,selectListArray){var selectElement=GetElementById(selectClientID);if(selectElement){this.SelectOptionsClear(selectElement);if(selectListArray){for(var i=0;i<selectListArray.length;i++){var e=selectListArray[i];var o=new Option(e.Text,e.Value);if(e.Selected=="true"){o.selected=true;}selectElement.options[selectElement.options.length]=o;}}}};this.AddAdditionalHiddenElementNamesToAppendToReturnUrl=function(elementName){if(AdditionalHiddenElementNamesToAppendToReturnUrl==null){AdditionalHiddenElementNamesToAppendToReturnUrl=new Array();}var found=false;for(var i=0;i<AdditionalHiddenElementNamesToAppendToReturnUrl.length;i++){if(AdditionalHiddenElementNamesToAppendToReturnUrl[i]==elementName){found=true;break;}}if(!found){AdditionalHiddenElementNamesToAppendToReturnUrl[AdditionalHiddenElementNamesToAppendToReturnUrl.length]=elementName;}};this.SelectMultipleCheckNoneSelected=function(element){element=GetElementById(element);if(element){if(element.length){if(element[0].selected==true){for(var i=1;i<element.length;i++){element[i].selected=false;}}}}};this.SelectOptionsClear=function(selectElement,keepSelected){selectElement=GetElementById(selectElement);if(selectElement){var selectedExists=false;var i=0;while(selectElement.options&&selectElement.options.length>i){if(keepSelected==true&&selectElement.options[i].selected==true){i+=1;continue;}else{selectElement.options[i]=null;}}}};this.SelectOptionsRemoveOption=function(selectElement,optionValue){selectElement=GetElementById(selectElement);if(selectElement){for(var i=0;i<selectElement.options.length;i++){var option=selectElement.options[i];if(option.value==optionValue){selectElement.options[i]=null;return true;break;}}}return false;};this.GetFormElementType=function(element){var type=null;if(element){type=element.type;if(type==null){if(element.length){type=element[0].type;}else if(element.tagName=="TABLE"||element.tagName=="DIV"){if(element.className&&element.className.indexOf("MetafuseComboBox")>=0){type="MetafuseComboBox";}else if(element.className&&element.className.indexOf("PropertySelector")>=0){type="PropertySelector";}else if(element.className&&element.className.indexOf("MetafuseKendoColorPicker")>=0){type="MetafuseKendoColorPicker";}else if(element.className&&element.className.indexOf("MetafuseKendoEditor")>=0){type="MetafuseKendoEditor";}else if(element.className&&element.className.indexOf("MetafuseKendoDatePicker")>=0){type="MetafuseKendoDatePicker";}else{var $checkboxes=$(element).find("input:checkbox");if($checkboxes&&$checkboxes.length){type="checkbox-list";}else{var radioElement=GetElementById(element.id+"_0");if(radioElement!=null&&radioElement.type!=null&&radioElement.type=="radio"){type="radio-button-list";}}}}}}return type;};this.GetFormElementValue=function(element,multipleSelectionValueSeparator){return this.Get(element,multipleSelectionValueSeparator);};this.Get=function(element,multipleSelectionValueSeparator){var element=GetElementById(element);if(element){var type=this.GetFormElementType(element);if(type==null){elementForm=document.forms[0][element.id];type=this.GetFormElementType(elementForm);if(type==null){alert("Unable to detect the type of form element for element id: "+element.id+" in GetFormElementValue");}}if(type=="select-multiple"||type=="select-one"){var values="";if(element.options){var useValue=true;if(element.options.length>1){var option1=element.options[0];var option2=element.options[1];if((option1.value==null||option1.value=="")&&(option2.value==null||option2.value=="")){useValue=false;}}if(multipleSelectionValueSeparator==null||multipleSelectionValueSeparator==""){multipleSelectionValueSeparator=",";}for(var i=0;i<element.options.length;i++){if(element.options[i].selected==true){if(values.length>0){values+=multipleSelectionValueSeparator;}if(useValue){values+=element.options[i].value;}else{values+=element.options[i].text;}if(type=="select-one"){break;}}}}return values;}else if(type=="checkbox"){if(element.checked){if(element.value!=null&&element.value!=""){return element.value;}else{return"on";}}}else if(type=="checkbox-list"){if(multipleSelectionValueSeparator==null||multipleSelectionValueSeparator==""){multipleSelectionValueSeparator=",";}return $(element).find("input[id^='"+element.id+"_']:checkbox:checked:enabled").map(function(){return this.value;}).get().join(multipleSelectionValueSeparator);}else if(type=="radio"){var radio=null;if(element.name){var name=new String(element.name);radio=document.forms[0][name];}if(radio==null){radio=document.forms[0][element.id];}if(radio==null){if(element==null){return"";}else{radio=element;}}if(radio){if(radio.length==null){if(radio.checked){return radio.value;}}else{for(var i=0;i<radio.length;i++){var r=radio[i];if(r.checked){return r.value;}}}}}else if(type=="MetafuseComboBox"){return FormTools.Get(element.id+"_sv",multipleSelectionValueSeparator);}else if(type=="MetafuseKendoColorPicker"){return FormTools.Get(element.id+"_h");}else if(type=="MetafuseKendoEditor"){var editor=$("#"+element.id+"_e").data("kendoEditor");if(editor){FormTools.Set(element.id+"_h",editor.value());return editor.value();}return"";}else if(type=="MetafuseKendoDatePicker"){var datepicker=$("#"+element.id+"_d").data("kendoDatePicker");if(datepicker){return datepicker.value();}return"";}else if(type=="PropertySelector"){var v=FormTools.Get(element.id+"_p");if(v!=null&&v!=""){for(var i=2;i<=5;i++){var vc=FormTools.Get(element.id+"_p"+i);if(vc!=null&&vc!=""){v+="."+vc;}else{i=10;}}}return v;}else if(type=="radio-button-list"){var radio=GetElementById(element.id+"_0");var i=0;while(radio!=null){if(radio.checked){return radio.value;}else{i+=1;radio=GetElementById(element.id+"_"+i.toString());}}}else{return element.value;}}return"";};this.GetFormElementText=function(clientId){return this.GetText(clientId);};this.GetText=function(clientId){element=GetElementById(clientId);if(element){var type=this.GetFormElementType(element);if(type==null){elementForm=document.forms[0][element.id];type=this.GetFormElementType(elementForm);if(type==null){alert("Unable to detect the type of form element for element id: "+element.id+" in GetFormElementText");}}if(type=="select-multiple"||type=="select-one"){var values="";if(element.options){for(var i=0;i<element.options.length;i++){if(element.options[i].selected==true){if(values.length>0){values+=", ";}values+=element.options[i].text;}}}return values;}else if(type=="checkbox"){if(element.checked){return"Yes";}else{return"No";}}else if(type=="radio"){var radio=null;if(element.name){var name=new String(element.name);radio=document.forms[0][name];}if(radio==null){radio=document.forms[0][element.id];}if(radio==null){if(element==null){return"";}else{radio=element;}}if(radio){var selectedRadio=null;if(radio.length==null){if(radio.checked){selectedRadio=radio;}}else{for(var i=0;i<radio.length;i++){var r=radio[i];if(r.checked){selectedRadio=r;}}}if(selectedRadio!=null&&selectedRadio.parentNode!=null){var parentNode=selectedRadio.parentNode;var labels=parentNode.getElementsByTagName('label');if(labels!=null&&labels.length>0){return labels[0].innerHTML;}else{return this.GetFormElementValue(element);}}else{return this.GetFormElementValue(element);}}}else if(type=="MetafuseComboBox"){var metafuseComboBoxElement=window[element.id+"_obj"];if(metafuseComboBoxElement){return metafuseComboBoxElement.GetFormElementText();}}else if(type=="MetafuseKendoEditor"){return element.innerHTML;}else if(type=="PropertySelector"){var elId=element.id+"_p";var t=FormTools.GetFormElementText(elId);if(t!=null&&t!=""){for(var i=2;i<=5;i++){var tc=FormTools.GetFormElementText(elId+i);if(tc!=null&&tc!=""){t+="."+tc;}else{i=10;}}}return t;}else if(type=="radio-button-list"){var radio=GetElementById(element.id+"_0");var i=0;while(radio!=null){if(radio.checked){if(radio.parentNode!=null){var labels=radio.parentNode.getElementsByTagName("LABEL");if(labels!=null&&labels.length>0){return labels[0].innerHTML;}}return radio.value;}else{i+=1;radio=GetElementById(element.id+"_"+i.toString());}}}else{return this.GetFormElementValue(element);}}return"";};this.GetFormElementOptionText=function(element,value){return this.GetOptionText(element,value);};this.GetOptionText=function(element,value){element=GetElementById(element);if(element){var type=this.GetFormElementType(element);if(type==null){elementForm=document.forms[0][element.id];type=this.GetFormElementType(elementForm);if(type==null){alert("Unable to detect the type of form element for element id: "+element.id+" in GetFormElementOptionText");}}if(type=="select-multiple"||type=="select-one"){if(element.options){for(var i=0;i<element.options.length;i++){if(element.options[i].value.toString()==value.toString()){return element.options[i].text;}}}}else if(type=="MetafuseComboBox"){var metafuseComboBoxElement=window[element.id+"_obj"];if(metafuseComboBoxElement){return metafuseComboBoxElement.GetFormElementOptionText(value);}}else if(type=="PropertySelector"){var elId=element.id+"_p";var t=FormTools.GetFormElementOptionText(elId,value);if(t!=null&&t!=""){for(var i=2;i<=5;i++){var tc=FormTools.GetFormElementOptionText(elId+i,t);if(tc!=null&&tc!=""){t+="."+tc;}else{i=10;}}}return t;}else if(type=="radio-button-list"){var radio=GetElementById(element.id+"_0");var i=0;while(radio!=null){if(radio.value==value.toString()){if(radio.parentNode!=null){var labels=radio.parentNode.getElementsByTagName("LABEL");if(labels!=null&&labels.length>0){return labels[0].innerHTML;}}return radio.value;}else{i+=1;radio=GetElementById(element.id+"_"+i.toString());}}}else{alert("Unable to get the form element option text for the element supplied "+element.id+" type not supported in GetFormElementOptionText");}}return"";};this.SetFormElementValue=function(clientId,value,text,valueSeparator,textSeparator,missionOptionArray,insertOptionsMissing,dropDownSelectWithMatchingValueOrTextOnOptions){return this.Set(clientId,value,text,valueSeparator,textSeparator,missionOptionArray,insertOptionsMissing,dropDownSelectWithMatchingValueOrTextOnOptions);};this.Set=function(clientId,value,text,valueSeparator,textSeparator,missionOptionArray,insertOptionsMissing,dropDownSelectWithMatchingValueOrTextOnOptions){if(value==null){return false;}if(valueSeparator==null){valueSeparator=",";}var element=GetElementById(clientId);var success=false;if(element){var type=this.GetFormElementType(element);if(type==null){elementForm=document.forms[0][element.id];type=this.GetFormElementType(elementForm);if(type==null){alert("Unable to detect the type of form element for element id: "+element.id+" in GetFormElementValue");}}if(type=="select-multiple"){var valueArray=null;var textArray=null;value=value.replace(valueSeparator+' ',valueSeparator);var valueArray=value.split(valueSeparator);if(text){text=text.replace(textSeparator+' ',textSeparator);textArray=text.split(textSeparator);}if(element.options.length){var useValue=true;if(element.options.length>1){var option1=element.options[0];var option2=element.options[1];if((option1.value==null||option1.value=="")&&(option2.value==null||option2.value=="")){useValue=false;}}for(var i=0;i<element.options.length;i++){var o=element.options[i];o.selected=false;for(var ii=0;ii<valueArray.length;ii++){var v=valueArray[ii];var foundMatch=false;if(useValue){if(o.value==v){o.selected=true;foundMatch=true;}else if(o.value==""&&v==""){o.selected=true;foundMatch=true;}else if(dropDownSelectWithMatchingValueOrTextOnOptions&&(o.text==v||jQuery.trim(o.text)==jQuery.trim(v))){o.selected=true;foundMatch=true;}}else{if(o.text.toString()==v.toString()){o.selected=true;foundMatch=true;}else if(o.text==""&&v==""){o.selected=true;foundMatch=true;}}if(foundMatch){valueArray.splice(ii,1);if(textArray){textArray.splice(ii,1);}break;}}}}if(valueArray.length>0){if(missionOptionArray!=null||insertOptionsMissing){if(missionOptionArray==null){missionOptionArray=new Array();}for(var i=0;i<valueArray.length;i++){var v=valueArray[i];var t=v;if(textArray&&textArray.length>i){t=textArray[i];}var opt={text:t,value:v};missionOptionArray[missionOptionArray.length]=opt;}}if(insertOptionsMissing&&missionOptionArray.length>0){for(var i=missionOptionArray.length-1;i>=0;i--){var missingOption=missionOptionArray[i];FormTools.InsertFormElementValueAndText(element,missingOption.value,missingOption.text,true,0);}success=true;}}else{success=true;}if(jQueryMobileInputRefreshEnabled){$(element).selectmenu('refresh');}}else if(type=="select-one"){if(element.options.length){var useValue=true;if(element.options.length>1){var option1=element.options[0];var option2=element.options[1];if((option1.value==null||option1.value=="")&&(option2.value==null||option2.value=="")){useValue=false;}}for(var i=0;i<element.options.length;i++){var o=element.options[i];if(useValue){if(o.value.toString()==value.toString()){o.selected=true;success=true;}else if(o.value==""&&value==""){o.selected=true;success=true;}else if(dropDownSelectWithMatchingValueOrTextOnOptions&&(o.text==value||jQuery.trim(o.text)==jQuery.trim(value))){o.selected=true;success=true;}}else{if(o.text.toString()==value.toString()){o.selected=true;success=true;}else if(o.text==""&&value==""){o.selected=true;success=true;}}if(success){break;}}}if(!success){if(missionOptionArray){var opt={text:text,value:value};missionOptionArray[missionOptionArray.length]=opt;}if(insertOptionsMissing){FormTools.InsertFormElementValueAndText(element,value,text,true,0);success=true;}}if(jQueryMobileInputRefreshEnabled){$(element).selectmenu('refresh');}}else if(type=="checkbox"){value=value.toString().toLowerCase();if(value=="on"||value=="true"||value=="1"||value=="checked"||value=="yes"||value=="active"||value==this.GlobalYes.toLowerCase()){element.checked=true
success=true;}else{element.checked=false;success=true;}if(jQueryMobileInputRefreshEnabled){$(element).checkboxradio('refresh');}}else if(type=="checkbox-list"){value=value.replace(valueSeparator+' ',valueSeparator);var valueArray=value.split(valueSeparator);var checkbox=GetElementById(element.id+"_0");var i=0;while(checkbox!=null){if(valueArray.indexOf(checkbox.value)>=0){checkbox.checked=true;success=true;}else{checkbox.checked=false;}i+=1;checkbox=GetElementById(element.id+"_"+i.toString());}}else if(type=="radio"){var radio=null;if(element.name){var name=new String(element.name);radio=document.forms[0][name];}if(radio==null){radio=document.forms[0][element.id];if(radio==null&&element!=null){radio=element;}}if(radio){if(radio.length==null){if(radio.value==value){radio.checked=true;success=true;}}else{for(var i=0;i<radio.length;i++){var r=radio[i];if(r.value==value){r.checked=true;success=true;}}}}if(jQueryMobileInputRefreshEnabled){$(element).checkboxradio('refresh');}}else if(type=="MetafuseComboBox"){var metafuseComboBoxElement=window[element.id+"_obj"];if(metafuseComboBoxElement){return metafuseComboBoxElement.SetFormElementValue(value,text,valueSeparator,textSeparator,missionOptionArray,insertOptionsMissing);}}else if(type=="MetafuseKendoColorPicker"){FormTools.Set(element.id+"_h",value);var colorPicker=$("#"+element.id+"_cp").data("kendoColorPicker");if(colorPicker){if(value==null||value==""){value="#ffffff";}try{var color=kendo.parseColor(value);colorPicker.value(color);}catch(ex){alert('Cannot parse color: "'+value+'" Exception: '+ex);}}}else if(type=="MetafuseKendoEditor"){FormTools.Set(element.id+"_h",value);var editor=$("#"+element.id+"_e").data("kendoEditor");if(editor){editor.refresh();editor.value(value);}}else if(type=="MetafuseKendoDatePicker"){FormTools.Set(element.id+"_h",value);var datePicker=$("#"+element.id+"_d").data("kendoDatePicker");if(datePicker){datePicker.value(value);}}else if(type=="PropertySelector"){var elId=element.id+"_p";if(value!=null&&value!=""){var va=value.split(".");var ta=va;if(text!=null&&text!=""){ta=text.split(".");}if(va.length>0){for(var i=1;i<=5;i++){var v="";var t="";var ext="";if(i>1){ext=i.toString();}if(va.length>=i){v=va[i-1];}if(ta.length>=i){t=ta[i-1];}FormTools.Set(elId+ext,v,t,null,insertOptionsMissing,dropDownSelectWithMatchingValueOrTextOnOptions);}}}}else if(type=="radio-button-list"){var radio=GetElementById(element.id+"_0");var i=0;while(radio!=null){if(radio.value==value){radio.checked=true;success=true;}else{radio.checked=false;}i+=1;radio=GetElementById(element.id+"_"+i.toString());}}else{element.value=value;success=true;}}return success;};this.InsertFormElementValueAndText=function(elementId,value,text,defaultSelected,index){this.InsertValueAndText(elementId,value,text,defaultSelected,index);};this.InsertValueAndText=function(elementId,value,text,defaultSelected,index){var element=GetElementById(elementId);if(element){var type=this.GetFormElementType(element);if(type==null){elementForm=document.forms[0][element.id];type=this.GetFormElementType(elementForm);if(type==null){alert("Unable to detect the type of form element for element id: "+element.id+" in GetFormElementValue");}}else if(type=="select-one"||type=="select-multiple"){var newOption=new Option(text,value);if(defaultSelected){newOption.selected=true;}if(element.length>0){if(index==null||index<0){index=0;}else if(index>element.length){index=element.options.length;}var existingOption=element.options[index];try{element.add(newOption,existingOption);}catch(ex){element.add(newOption,index);}}else{element.options[0]=newOption;}}else if(type=="MetafuseComboBox"){var metafuseComboBoxElement=window[element.id+"_obj"];if(metafuseComboBoxElement){metafuseComboBoxElement.AddAvailableRow(value,text,defaultSelected);}}else{alert("insert form field and text not implemented for element type: "+type+" id: "+element.id+" value: "+value+" text: "+text);}}return null;};this.RemoveFormElementValueAndText=function(elementId,value,text){this.RemoveValueAndText(elementId,value,text);};this.RemoveValueAndText=function(elementId,value,text){var element=GetElementById(elementId);if(element){var type=this.GetFormElementType(element);if(type==null){elementForm=document.forms[0][element.id];type=this.GetFormElementType(elementForm);if(type==null){alert("Unable to detect the type of form element for element id: "+element.id+" in GetFormElementValue");}}else if(type=="select-one"||type=="select-multiple"){var start=element.options.length-1;for(var i=start;i>=0;i--){var o=element.options[i];if(o){if(value!=null){if(o.value!=null&&o.value==value){element.options[i]=null;}}else if(text!=null){if(o.text!=null&&o.text==text){element.options[i]=null;}}}}}else if(type=="MetafuseComboBox"){var metafuseComboBoxElement=window[element.id+"_obj"];if(metafuseComboBoxElement){metafuseComboBoxElement.RemoveAvailableRow(value,text);}}else{alert("remove form field and text not implemented for element type: "+type);}}};this.SetValueUsingSetTimeout=function(elementId,value){var element=GetElementById(elementId);if(element){var s=new String("");if(value){s=value.toString();}setTimeout("FormTools.Set('"+element.id+"',\""+s.replace(/\"/g,"\\\"")+"\")",0);}};this.FocusAndClickElementUsingSetTimeout=function(element){var element=GetElementById(element);if(element){setTimeout("GetElementById('"+element.id+"').focus()",0);setTimeout("UITools.ClickElement('"+element.id+"')",100);}};this.GetAttrOrValue=function(element,attributeName){var v="";element=GetElementById(element);if(element!=null){v=$(element).attr(attributeName);if(v==null||v==""){v=this.Get(element);}}return v;};this.SetAttrAndValue=function(element,attributeName,attributeValue,elementValue){element=GetElementById(element);if(element!=null){$(element).attr(attributeName,attributeValue);if(attributeValue!=null&&attributeValue!=""&&(elementValue==null||elementValue=="")){elementValue=attributeValue;}this.Set(element,elementValue);return true;}return false;};this.GetAttrOrValue=function(element,attributeName){var v="";element=GetElementById(element);if(element!=null){v=$(element).attr(attributeName);if(v==null||v==""){v=this.Get(element);}}return v;};this.EnsureCurrency=function(element,blankNotAllowed,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale){var value=FormTools.Get(element);var currencyString=MathTools.FormatCurrencyString(value,!blankNotAllowed,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale);if(value!=currencyString){FormTools.SetValueUsingSetTimeout(element,currencyString);}};this.EnsurePositiveCurrency=function(element,blankNotAllowed,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale){var value=FormTools.Get(element);var currencyString=MathTools.FormatCurrencyString(value,!blankNotAllowed,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale,true);if(value!=currencyString){FormTools.SetValueUsingSetTimeout(element,currencyString);}};this.EnsureDecimal=function(element,blankNotAllowed,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale){var value=FormTools.Get(element);var decimalString=MathTools.FormatDecimalString(value,!blankNotAllowed,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale);if(value!=decimalString){FormTools.SetValueUsingSetTimeout(element,decimalString);}};this.EnsurePositiveDecimal=function(element,blankNotAllowed,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale){var value=FormTools.Get(element);var value=FormTools.Get(element);var decimalString=MathTools.FormatDecimalString(value,!blankNotAllowed,excludeCommas,excludeLeadingZero,excludeTrailingZeros,scale,true);if(value!=decimalString){FormTools.SetValueUsingSetTimeout(element,decimalString);}};this.EnsureInteger=function(element,blankNotAllowed,excludeCommas){var value=FormTools.Get(element);var integerString=MathTools.FormatDecimalString(value,!blankNotAllowed,excludeCommas,false,false,0);if(value!=integerString){FormTools.SetValueUsingSetTimeout(element,integerString);}};this.EnsurePositiveInteger=function(element,blankNotAllowed,excludeCommas){var value=FormTools.Get(element);var integerString=MathTools.FormatDecimalString(value,!blankNotAllowed,excludeCommas,false,true,0,true);if(value!=integerString){FormTools.SetValueUsingSetTimeout(element,integerString);}};this.EnsurePercent=function(element,blankNotAllowed,excludeLeadingZero,excludeTrailingZeros,scale){var value=FormTools.Get(element);var percentString="";if((value!=null&&value!="")||blankNotAllowed){percentString=MathTools.FormatPercentString(value,!blankNotAllowed,excludeLeadingZero,excludeTrailingZeros,scale);}if(value!=percentString){FormTools.SetValueUsingSetTimeout(element,percentString);}};this.EnsureHoursMinutes=function(element,nearestMinutes,roundDirection){var value=FormTools.Get(element);var timeString="";if((value!=null&&value!="")){timeString=MathTools.FormatHoursAndMinutesString(value,nearestMinutes,roundDirection);}if(value!=timeString){FormTools.SetValueUsingSetTimeout(element,timeString);}};this.EnsureDurationString=function(element){var value=FormTools.Get(element);var d=MathTools.DurationStringToObject(value);var s=MathTools.FormatDurationStringFromObj(d);if(s!=value){FormTools.SetValueUsingSetTimeout(element,s);}};this.SelectBoxMoveSelectedItemsUp=function(selectElement){selectElement=GetElementById(selectElement);var optionsToMove=new Array();var firstMoveOptionIndex=-1;var optionOrder=new Array();var optionMoved=false;for(var i=selectElement.options.length-1;i>=0;i--){var currentOption=selectElement.options[i];if(currentOption.selected==true&&(i>0)){if(optionsToMove.length==0){firstMoveOptionIndex=i;}optionsToMove[optionsToMove.length]=currentOption;}else if(optionsToMove.length>0){optionMoved=true;optionOrder[optionOrder.length]=currentOption;for(var ii=0;ii<optionsToMove.length;ii++){optionOrder[optionOrder.length]=optionsToMove[ii];}optionsToMove=new Array();}else{optionOrder[optionOrder.length]=currentOption;}}if(optionMoved==true){while(selectElement.options.length>0){selectElement.options[0]=null;}for(var i=optionOrder.length-1;i>=0;i--){selectElement.options[selectElement.options.length]=optionOrder[i];}}};this.SelectBoxMoveSelectedItemsDown=function(selectElement){selectElement=GetElementById(selectElement);var optionsToMove=new Array();var firstMoveOptionIndex=-1;var optionOrder=new Array();var optionMoved=false;for(var i=0;i<selectElement.options.length;i++){var currentOption=selectElement.options[i];if(currentOption.selected==true&&(i+1<selectElement.options.length)){if(optionsToMove.length==0){firstMoveOptionIndex=i;}optionsToMove[optionsToMove.length]=currentOption;}else if(optionsToMove.length>0){optionMoved=true;optionOrder[optionOrder.length]=currentOption;for(var ii=0;ii<optionsToMove.length;ii++){optionOrder[optionOrder.length]=optionsToMove[ii];}optionsToMove=new Array();}else{optionOrder[optionOrder.length]=currentOption}}if(optionMoved==true){while(selectElement.options.length>0){selectElement.options[0]=null;}for(var i=0;i<optionOrder.length;i++){selectElement.options[selectElement.options.length]=optionOrder[i];}}};this.SortSelectByTextAsString=function(selectElement){selectElement=GetElementById(selectElement);if(selectElement.options.length>1){var a=new Array();for(var i=0;i<selectElement.options.length;i++){a[a.length]=selectElement.options[i];}a.sort(FormTools.CompareSelectTextAsString);while(selectElement.options.length>0){selectElement.options[0]=null;}for(var i=0;i<a.length;i++){selectElement.options[selectElement.options.length]=a[i];}}};this.CompareSelectTextAsString=function(optionA,optionB){if(optionA.text==optionB.text){return 0;}else{if(optionA.text<optionB.text){return-1;}else{return 1;}}};this.SetCheckboxLabelText=function(checkbox,text){checkbox=GetElementById(checkbox);if(checkbox&&FormTools.GetFormElementType(checkbox)=="checkbox"&&checkbox.nextSibling&&checkbox.nextSibling.tagName=="LABEL"){checkbox.nextSibling.innerHTML=text;}};this.CalculateHoursRateTotal_HoursChanged=function(hId,rId,tId,dontAllowEmpty,eId,ttId,disable){var rateScale=null;if(UITools.GetPIAttr(rId,"scale")){rateScale=new Number(UITools.GetPIAttr(rId,"scale"));}if(disable){this.Set(hId,MathTools.FormatDecimalString(this.Get(hId)));return;}var hi=GetElementById(hId);var ri=GetElementById(rId);var ti=GetElementById(tId);var ei=GetElementById(eId);var tti=GetElementById(ttId);var hs=this.Trim(this.Get(hi));var rs=this.Trim(this.Get(ri));var ts=this.Trim(this.Get(ti));var es=this.Trim(this.Get(ei));var tts=this.Trim(this.Get(tti));var h=0;var r=0;var t=0;var e=0;var tt=0;h=MathTools.ParseFloat(hs);if(rs!=""){r=MathTools.ParseFloat(rs);t=h*r;}else if(ts!=""){t=MathTools.ParseFloat(ts);if(h>0){r=t/h;}}if(es!=""){e=MathTools.ParseFloat(es);}tt=t+e;if(hs!=""||h!=0||dontAllowEmpty){this.Set(hId,MathTools.FormatDecimalString(h));}if(rs!=""||r!=0||dontAllowEmpty){if(rateScale){this.Set(rId,MathTools.FormatCurrencyString(r,null,null,null,null,rateScale));}else{this.Set(rId,MathTools.FormatCurrencyString(r));}}else if(rs==""){this.Set(rId,"");}if(ts!=""||t!=0||dontAllowEmpty){this.Set(tId,MathTools.FormatCurrencyString(t));}else if(ts==""){this.Set(tId,"");}if(eId){if(es!=""||e!=0||dontAllowEmpty){this.Set(eId,MathTools.FormatCurrencyString(e));}else if(es==""){this.Set(eId,"");}}if(ttId){if(tts!=""||tt!=0||dontAllowEmpty){this.Set(ttId,MathTools.FormatCurrencyString(tt));}else if(tts==""){this.Set(ttId,"");}}};this.CalculateHoursRateTotal_RateChanged=function(hId,rId,tId,dontAllowEmpty,eId,ttId,disable){var rateScale=null;if(UITools.GetPIAttr(rId,"scale")){rateScale=new Number(UITools.GetPIAttr(rId,"scale"));}if(disable){if(rateScale){this.Set(rId,MathTools.FormatCurrencyString(this.Get(rId),null,null,null,null,rateScale));}else{this.Set(rId,MathTools.FormatCurrencyString(this.Get(rId)));};return;}var hs=this.Trim(this.Get(hId));var rs=this.Trim(this.Get(rId));var ts=this.Trim(this.Get(tId));var es=this.Trim(this.Get(eId));var tts=this.Trim(this.Get(ttId));var h=0;var r=0;var t=0;var e=0;var tt=0;r=MathTools.ParseFloat(rs);if(hs!=""){h=MathTools.ParseFloat(hs);t=h*r;}else if(ts!=""){t=MathTools.ParseFloat(ts);if(r>0){h=t/r;}}if(es!=""){e=MathTools.ParseFloat(es);}tt=t+e;if(hs!=""||h!=0||dontAllowEmpty){this.Set(hId,MathTools.FormatDecimalString(h));}else if(hs==""){this.Set(hId,"");}if(rs!=""||r!=0||dontAllowEmpty){if(rateScale){this.Set(rId,MathTools.FormatCurrencyString(r,null,null,null,null,rateScale));}else{this.Set(rId,MathTools.FormatCurrencyString(r));}}if(ts!=""||t!=0||dontAllowEmpty){this.Set(tId,MathTools.FormatCurrencyString(t));}else if(ts==""){this.Set(tId,"");}if(eId){if(es!=""||e!=0||dontAllowEmpty){this.Set(eId,MathTools.FormatCurrencyString(e));}else if(es==""){this.Set(eId,"");}}if(ttId){if(tts!=""||tt!=0||dontAllowEmpty){this.Set(ttId,MathTools.FormatCurrencyString(tt));}else if(tts==""){this.Set(ttId,"");}}};this.CalculateHoursRateTotal_TotalChanged=function(hId,rId,tId,dontAllowEmpty,eId,ttId,disable){if(disable){this.Set(tId,MathTools.FormatDecimalString(this.Get(tId)));return;}var hs=this.Trim(this.Get(hId));var rs=this.Trim(this.Get(rId));var ts=this.Trim(this.Get(tId));var es=this.Trim(this.Get(eId));var tts=this.Trim(this.Get(ttId));var h=0;var r=0;var t=0;var e=0;var tt=0;t=MathTools.ParseFloat(ts);if(hs!=""){h=MathTools.ParseFloat(hs);if(h>0){r=t/h;}}else if(rs!=""){r=MathTools.ParseFloat(rs);if(r>0){h=t/r;}}if(es!=""){e=MathTools.ParseFloat(es);}tt=t+e;if(hs!=""||h!=0||dontAllowEmpty){this.Set(hId,MathTools.FormatDecimalString(h));}else if(hs==""){this.Set(hId,"");}if(rs!=""||r!=0||dontAllowEmpty){this.Set(rId,MathTools.FormatCurrencyString(r));}if(ts!=""||t!=0||dontAllowEmpty){this.Set(tId,MathTools.FormatCurrencyString(t));}if(eId){if(es!=""||e!=0||dontAllowEmpty){this.Set(eId,MathTools.FormatCurrencyString(e));}else if(es==""){this.Set(eId,"");}}if(ttId){if(tts!=""||tt!=0||dontAllowEmpty){this.Set(ttId,MathTools.FormatCurrencyString(tt));}else if(tts==""){this.Set(ttId,"");}}};this.CalculateTimeExpTotal_ExpChanged=function(tId,eId,ttId,dontAllowEmpty,disable){if(disable){this.Set(eId,MathTools.FormatDecimalString(this.Get(eId)));return;}var ts=this.Trim(this.Get(tId));var es=this.Trim(this.Get(eId));var tts=this.Trim(this.Get(ttId));var t=0;var e=0;var tt=0;t=MathTools.ParseFloat(ts);if(es!=""){e=MathTools.ParseFloat(es);}tt=t+e;if(eId){if(es!=""||e!=0||dontAllowEmpty){this.Set(eId,MathTools.FormatCurrencyString(e));}else if(es==""){this.Set(eId,"");}}if(ttId){if(tts!=""||tt!=0||dontAllowEmpty){this.Set(ttId,MathTools.FormatCurrencyString(tt));}else if(tts==""){this.Set(ttId,"");}}};this.CalculateTimeExpTotal_TotalChanged=function(tId,eId,ttId,dontAllowEmpty,disable){if(disable){this.Set(ttId,MathTools.FormatDecimalString(this.Get(ttId)));return;}var ts=this.Trim(this.Get(tId));var es=this.Trim(this.Get(eId));var tts=this.Trim(this.Get(ttId));var t=0;var e=0;var tt=0;tt=MathTools.ParseFloat(tts);if(ts!=""){t=MathTools.ParseFloat(ts);e=tt-t;}else if(es!=""){e=tt;}if(eId){if(es!=""||e!=0||dontAllowEmpty){this.Set(eId,MathTools.FormatCurrencyString(e));}else if(es==""){this.Set(eId,"");}}if(ttId){if(tts!=""||tt!=0||dontAllowEmpty){this.Set(ttId,MathTools.FormatCurrencyString(tt));}else if(tts==""){this.Set(ttId,"");}}};this.WindowOpenWithPost=function(url,params,name,windowoption){var form=document.createElement("form");form.setAttribute("method","post");form.setAttribute("action",url);if(name!=null){form.setAttribute("target",name);}if(params!=null){for(var i in params){if(params.hasOwnProperty(i)){var input=document.createElement('input');input.type='hidden';input.name=i;input.value=params[i];form.appendChild(input);}}}document.body.appendChild(form);if(name!=null){window.open(Root+"/post.htm",name,windowoption);}form.submit();document.body.removeChild(form);};this.Trim=function(stringToTrim){return Utils.Trim(stringToTrim);};this.LTrim=function(stringToTrim){return Utils.LTrim(stringToTrim);};this.RTrim=function(stringToTrim){return Utils.RTrim(stringToTrim);};this.ValidatorEnable=function(elementId,enabled){if(isString(elementId)&&elementId.indexOf(",")>0){var els=elementId.split(",");for(var i=0;i<els.length;i++){this.ValidatorEnable(els[i],enabled);}return;}var e=GetElementById(elementId);if(e!=null){ValidatorEnable(e,enabled);var hiddenId=e.id+"_edcs";var hidden=GetElementById(hiddenId);if(hidden==null){$('<input>').attr({type:'hidden',id:hiddenId,name:hiddenId,value:enabled.toString().toLowerCase()}).appendTo('form');}}};this.ProcessApiResponseErrorList=function(apiResponse,formElementScope){if(apiResponse!=null&&isObject(apiResponse)&&apiResponse["Errors"]!=null&&isArray(apiResponse.Errors)&&!apiResponse.Success){var scope=GetElementById(formElementScope);var errorMessage=FormTools.FormatApiResponseErrorList(apiResponse);if(scope){var $scope=$(scope);var validationSummary=$scope.find('.validation-box,.ValidationSummary');if(validationSummary&&validationSummary.length>0){var valDiv=validationSummary[0];$(valDiv).html(errorMessage);$(valDiv).show();}}for(var i=0;i<apiResponse.Errors.length;i++){var e=apiResponse.Errors[i];if(e.Property&&e.Property!=""){var inputs=$scope.find('[data-pi-property="'+e.Property+'"]');if(inputs&&inputs.length>0){inputs.addClass("ValidationError");}}}return false;};return true;};this.ClearApiResponseErrorList=function(formElementScope){var scope=GetElementById(formElementScope);if(scope){var $scope=$(scope);var validationSummary=$scope.find('.validation-box,.ValidationSummary');if(validationSummary&&validationSummary.length>0){var valDiv=validationSummary[0];$(valDiv).html("");$(valDiv).hide();}$scope.find('.ValidationError').removeClass('ValidationError');}};this.FormatApiResponseErrorList=function(apiResponse){if(apiResponse!=null&&isObject(apiResponse)&&apiResponse["Errors"]!=null&&isArray(apiResponse.Errors)&&!apiResponse.Success){var msg="";for(var i=0;i<apiResponse.Errors.length;i++){var err=apiResponse.Errors[i];if(err.ErrorMessage!=null&&err.ErrorMessage!=""){msg+="<li>"+err.ErrorMessage+"</li>";}}if(msg!=""){msg="<ul class=\"ValidationSummary\">"+msg+"</ul>";return msg;}}return apiResponse;};this.PostToUrl=function(path,params,formName,method){method=method||"post";if(formName==null||formName==""){formName=new Date().valueOf();}var form=document.createElement("form");form.setAttribute("name",formName);form.setAttribute("method",method);form.setAttribute("action",path);for(var key in params){if(params.hasOwnProperty(key)){var hiddenField=document.createElement("input");hiddenField.setAttribute("type","hidden");hiddenField.setAttribute("name",key);hiddenField.setAttribute("value",params[key]);form.appendChild(hiddenField);}}document.body.appendChild(form);form.submit();};this.ToggleCheckboxPair=function(checkboxId,checkboxIdToToggle){var checkbox=GetElementById(checkboxId);if(checkbox&&checkbox.checked){this.Set(checkboxIdToToggle,"0");}};this.GetPropertyValue=function(obj,propertyString){if(obj!=null){var p=propertyString.split(".");for(var i=0;i<p.length;i++){obj=obj[p[i]];if(obj==null){return null;}};}return obj;};this.GetObj=function(container){container=GetElementById(container);var obj=null;if(container){var $container=$(container);var inputs=$container.find("[data-pi-property], [data-pi-array]");for(var i=0;i<inputs.length;i++){var input=inputs[i];var parent=input.parentNode;while(parent!=null){if(parent==container){parent=null;}else if($(parent).attr("data-pi-form")!=null){parent=null;input=null;}else{parent=parent.parentNode;}}if(input){var arrayProp=UITools.GetPIAttr("array");if(arrayProp!=null&&arrayProp!=""){var array=this.GetObjArray(input);if(array!=null){if(obj==null){obj=new Object();}obj["arrayProp"]=array;}}else{var prop=UITools.GetPIAttr(input,"property");if(prop!=null&&prop!=""){if(obj==null){obj=new Object();}var $input=$(input);var data=$input.data("data-pi-value-data");if(data!=null){obj[prop]=data;}else{var value=$input.attr("data-pi-value");if(value==null){if(input.tagName=="TD"||input.tagName=="TH"||input.tagName=="DIV"||input.tagName=="SPAN"||input.tagName=="P"){value=input.innerHTML;}else{value=FormTools.Get(input);if(FormTools.GetFormElementType(input)=="checkbox"&&value=="on"){value="True";}}}obj[prop]=value;}}}}}if(obj!=null){if(obj["id"]==null){var id=UITools.GetPIAttr(container,"id");if(id!=null&&id!=""){obj["id"]=id;}}if(obj["obj_type"]==null){var type=UITools.GetPIAttr(container,"object-type");if(type!=null&&type!=""){obj["obj_type"]=type;}}}}return obj;};this.GetObjArray=function(container){container=GetElementById(container);var array=null;if(container){var $container=$(container);var elements=$container.find("[data-pi-id]");for(var i=0;i<elements.length;i++){var element=elements[i];var obj=this.GetObj(element);if(obj!=null){if(array==null){array=new Array();}array[array.length]=obj;}}}return array;};};var FormTools=new FormTools();function Utils(){this.DateTime=new Utils.DateTime();this.Trim=function(stringToTrim){if(stringToTrim){return stringToTrim.replace(/^\s\s*/,'').replace(/\s\s*$/,'');}return stringToTrim;};this.LTrim=function(stringToTrim){if(stringToTrim){return stringToTrim.replace(/^\s\s*/,'');}return stringToTrim;};this.RTrim=function(stringToTrim){if(stringToTrim){return stringToTrim.replace(/\s\s*$/,'');}return stringToTrim;};this.GetNextTableRow=function(row){row=GetElementById(row);if(row!=null){var nextRow=row.nextSibling;while(nextRow!=null&&nextRow.nodeName!="TR"){nextRow=nextRow.nextSibling;}if(nextRow!=null&&nextRow.nodeName=="TR"){return nextRow;}}return null;};this.ExecuteFunctionByName=function(functionName,context){if(functionName!=null&&functionName!=""){var args=[].slice.call(arguments).splice(2);var namespaces=functionName.split(".");var func=namespaces.pop();if(context==null){context=window;}for(var i=0;i<namespaces.length;i++){context=context[namespaces[i]];}return context[func].apply(context,args);}return null;};}Utils.DateTime=function(){this.GetDayOfWeekDescription=function(date){date=new Date(date);var day=date.getDay();if(day==0){return"Sunday";}else if(day==1){return"Monday";}else if(day==2){return"Tuesday";}else if(day==3){return"Wednesday";}else if(day==4){return"Thursday";}else if(day==5){return"Friday";}else{return"Saturday";}};this.AddDays=function(date,daysToAdd){date=new Date(date);date.setDate(date.getDate()+daysToAdd);return date;};this.GetDifferenceInDays=function(latestDate,earliestDate){var diff=Math.round((latestDate-earliestDate)/(1000*60*60*24));return diff;};};var Utils=new Utils();function BrowserTools(){this.BrowserIsTabletDevice=false;this.BrowserIsMobileDevice=false;this.IsInternetExplorer=function(){if(navigator.userAgent.indexOf("MSIE")>=0){return true;}else if(navigator.userAgent.match("Trident\/7.0;.*rv:11.0")){return true;}else{return false;}};this.IsChrome=function(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){return true;}return false;};this.IsNetscape=function(){if(this.IsSafari()){return false;}else if(this.IsFirefox()){return false;}else{if(navigator.appName.toLowerCase().indexOf("netscape")>-1){return true;}else{return false;}}};this.IsSafari=function(){if(navigator.userAgent.toLowerCase().indexOf("safari")>-1&&this.IsChrome()==false){return true;}return false;};this.IsFirefox=function(){if(navigator.userAgent.indexOf("Firefox")>-1){return true;}else{return false;}};this.GetMajorVersion=function(){var userAgt=navigator.userAgent
if(this.IsInternetExplorer()){var verOffset=userAgt.indexOf("MSIE");return parseFloat(userAgt.substring(verOffset+5,userAgt.length));}else{alert("Unsupported for the browser");}return parseFloat(navigator.appVersion);};this.IsTouchEnabled=function(){return('ontouchstart'in window)||('onmsgesturechange'in window);};this.IsTouchStartEnabled=function(){return('ontouchstart'in window);};};var BrowserTools=new BrowserTools();function __Dump(object,insertIntoPage){if(insertIntoPage){InsertHTML("<p><textarea style=\"width:100%\" rows=\"10\">"+__GetObjectProperties(object)+"</textarea></p>");}else{alert(__GetObjectProperties(object));}}function __GetObjectProperties(obj){var properties=new String();if(isString(obj)){return obj;}for(var i in obj){var msg=i+": "+obj[i]+"\t";var msgString=new String();msgString=msg.toString()
msgString=msgString.substring(0,100);properties+=msgString;}return properties;}function MetafuseModalVeil(){this.ElementQueue=null;this.VeilElement=null;this.VeilElementShim=null;this.VeilZIndex=0;this.ShowVeilUnderElement=function(element,elementShim){element=GetElementById(element)
if(element){if(this.ElementQueue==null){this.ElementQueue=new Array();UITools.InsertHTML("<div id=\"metafuseVeilObjectDiv\" class=\"Veil\"></div>");this.VeilElement=GetElementById("metafuseVeilObjectDiv");var self=this;OnWindowResizeFunctions.AddFunction(function(){self.SetDimensions();});OnScrollFunctions.AddFunction(function(){self.SetDimensions();});this.SetDimensions();}if(this.ElementQueue.length>0){var currentElement=this.ElementQueue[this.ElementQueue.length-1];var cElz=MathTools.ParseFloat(currentElement.style.zIndex);var elz=MathTools.ParseFloat(element.style.zIndex);if(cElz>=elz){var index=cElz+5;element.style.zIndex=index;}}this.VeilElement.style.zIndex=element.style.zIndex-2;this.VeilElement.style.display="";if(elementShim){var index=MathTools.ParseFloat(element.style.zIndex);elementShim.style.zIndex=index-1;}if(this.VeilElementShim){this.VeilElementShim.style.zIndex=this.VeilElement.style.zIndex-1;this.VeilElementShim.style.display="";}this.ElementQueue[this.ElementQueue.length]=element;}};this.HideVeilUnderElement=function(element){if(this.ElementQueue!=null&&this.ElementQueue.length>0){this.ElementQueue=this.RemoveDuplicates(this.ElementQueue);var elementHadVeil=false;element=GetElementById(element);if(element){for(var i=0;i<this.ElementQueue.length;i++){var elementQueue=this.ElementQueue[i];if(elementQueue){if(elementQueue.id==element.id){this.ElementQueue.splice(i,1);elementHadVeil=true;break;}}}if(elementHadVeil){if(this.ElementQueue.length>0){var lastElement=this.ElementQueue[this.ElementQueue.length-1];this.VeilElement.style.zIndex=lastElement.style.zIndex-1;if(this.VeilElementShim){this.VeilElementShim.style.zIndex=this.VeilElement.style.zIndex-1;}}else{this.VeilElement.style.display="none";this.VeilElement.style.zIndex=0;if(this.VeilElementShim){this.VeilElementShim.style.display="none";this.VeilElementShim.style.zIndex=0;}}}}}};this.RemoveDuplicates=function(elementQueue){this.retQueue=new Array();this.retQueueIds=new Array();this.retQueue.push(elementQueue[0]);this.retQueueIds.push(elementQueue[0].id);for(var i=1;i<elementQueue.length;i++){if(!this.retQueueIds.contains(elementQueue[i].id)){this.retQueue.push(elementQueue[i]);}}return this.retQueue;};Array.prototype.contains=function(obj){var i=this.length;while(i--){if(this[i]===obj){return true;}}return false;};this.SetDimensions=function(){if(this.VeilElement!=null&&this.VeilElement.style.display==""){var docW=UITools.GetElementWidth(document);var docH=UITools.GetElementHeight(document);var w=UITools.GetWindowWidth()+UITools.GetScrollLeft();var h=UITools.GetWindowHeight()+UITools.GetScrollTop();w=Math.max(w,docW);h=Math.max(h,docH);this.VeilElement.style.width=w+'px';this.VeilElement.style.height=h+'px';if(this.VeilElementShim){this.VeilElementShim.style.width=w+'px';this.VeilElementShim.style.height=h+'px';}}};};var metafuseVeil=new MetafuseModalVeil();function MetafuseImageUrl(root,extension,basePath){if(root==null){root="";}this.ext=".svg";this.b="/i/i";if(basePath){if(basePath.indexOf("/")<0){basePath="/i/"+basePath;}this.b=basePath;}if(root!=""){this.b=root+this.b;}if(extension){this.ext=extension;}this.ItemClosedArrow=this.b+"/TreeArrow"+this.ext;this.ItemOpenArrow=this.b+"/TreeArrowDown"+this.ext;this.SortColumnAscArrow=this.b+"/SortArrowUp"+this.ext;this.SortColumnDescArrow=this.b+"/SortArrowDown"+this.ext;this.Edit=this.b+"/Edit"+this.ext;this.Delete=this.b+"/Delete"+this.ext;this.Add=this.b+"/Add"+this.ext;this.Remove=this.b+"/Remove"+this.ext;this.PinDown=this.b+"/PinDown"+this.ext;this.PinRight=this.b+"/PinRight"+this.ext;this.OnIt=this.b+"/onit"+this.ext;this.OnItRemove=this.b+"/onit-o"+this.ext;this.DCClose=root+"/i/c.gif";};var MFImg=new MetafuseImageUrl();function SelectOptionsClear(selectElement,keepSelected){FormTools.SelectOptionsClear(selectElement,keepSelected);};function ListBoxCheckNoneSelected(element){FormTools.SelectMultipleCheckNoneSelected(element);};function SubmitUsingSetTimeout(element){FormTools.FocusAndClickElementUsingSetTimeout(element);};function GetPageXCoordinate(element){return UITools.GetPageXCoordinate(element);};function GetPageYCoordinate(element){return UITools.GetPageYCoordinate(element);};function GetEventPageXCoordinate(localEvent){return UITools.GetEventPageXCoordinate(localEvent);};function GetEventPageYCoordinate(localEvent){return UITools.GetEventPageYCoordinate(localEvent);};function GetWindowHeight(){return UITools.GetWindowHeight();};function GetWindowWidth(){return UITools.GetWindowWidth();};function GetScrollLeft(){return UITools.GetScrollLeft();};function GetScrollTop(){return UITools.GetScrollTop();};function ShowDivAndIFrameAtEvent(localEvent,divElement,iframe,offsetX,offsetY){UITools.ShowDivAndIFrameAtEvent(localEvent,divElement,iframe,offsetX,offsetY);};function ShowDivAndIFrameAtXY(x,y,divElement,iframe,offsetX,offsetY){UITools.ShowDivAndIFrameAtXY(x,y,divElement,iframe,offsetX,offsetY);};function HideDivAndIFrame(divElement,iframe){UITools.HideDivAndIFrame(divElement,iframe);};function FocusOnElement(elementToFocus){UITools.FocusOnElement(elementToFocus);};function DisableElement(elementNameToDisable){UITools.DisableElement(elementNameToDisable);};function EnableElement(elementNameToEnable){UITools.EnableElement(elementNameToEnable);};function ToggleElementDisable(elementName,enable){UITools.ToggleElementDisable(elementName,enable);};function ToggleDisplay(element,hide){return UITools.ToggleDisplay(element,hide);};function InsertHTML(html){UITools.InsertHTML(html);};function IsNumeric(inputString){return MathTools.IsNumeric(inputString);};function FormatCurrency(num){return MathTools.FormatCurrencyString(num);};function Round(dNumber,iDecimalPlaces,includeTrailingZeros){if(iDecimalPlaces>0&&!includeTrailingZeros){alert("depricated functionality, check the function");}return MathTools.Round(dNumber,iDecimalPlaces);};function IsEven(integer){return MathTools.IsEven(integer);};