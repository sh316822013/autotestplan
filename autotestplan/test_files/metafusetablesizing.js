var __paneResizerMoving=false;var __paneResizerMovingProcessing=false;var __paneDividerBarElement;var __paneLocalEventXCoordinate;var __leftPaneElementsArray;var __rightPaneElementsArray;var __leftPaneWidthHiddenField;var __rightPaneScrollingDisabled=false;function PaneResizerMouseDown(localEvent,splitScreenTableName,dividerBarName,leftPanesNamesArray,rightPanesNamesArray,leftPaneWidthHiddenFieldName,rightPaneScrollingDisabled){__paneResizerMoving=true;__leftPaneElementsArray=new Array(leftPanesNamesArray.length);__rightPaneElementsArray=new Array(rightPanesNamesArray.length);__paneDividerBarElement=GetElementById(dividerBarName);__leftPaneWidthHiddenField=GetElementById(leftPaneWidthHiddenFieldName);__rightPaneScrollingDisabled=rightPaneScrollingDisabled;for(var i=0;i<leftPanesNamesArray.length;i++){var element=GetElementById(leftPanesNamesArray[i])
__leftPaneElementsArray[i]=element;}for(var i=0;i<rightPanesNamesArray.length;i++){var element=GetElementById(rightPanesNamesArray[i]);__rightPaneElementsArray[i]=element;}if(navigator.appName=="Netscape"){__paneLocalEventXCoordinate=localEvent.pageX;AddEventHandlerToElement(document,"onmousemove",PaneResizerMovingNetscape);AddEventHandlerToElement(document,"onmouseup",PaneResizerMouseUp);localEvent.preventDefault();}else{__paneDividerBarElement.setCapture();__paneLocalEventXCoordinate=event.clientX;}}function PaneResizerMovingNetscape(e){if(__paneResizerMoving==true){if(__paneResizerMovingProcessing==false){__paneResizerMovingProcessing=true;var x=e.pageX;var deltax=new Number(x-__paneLocalEventXCoordinate);__paneLocalEventXCoordinate=x;if(deltax!=0){var width;for(var i=0;i<__leftPaneElementsArray.length;i++){var paneElement=__leftPaneElementsArray[i];if(paneElement){var $paneElement=$(paneElement);width=new Number($paneElement.width())+deltax;if(width<0){width=0;}paneElement.style.width=width+"px";}}if(__leftPaneWidthHiddenField){__leftPaneWidthHiddenField.value=width;}if(__rightPaneScrollingDisabled==false){for(var i=0;i<__rightPaneElementsArray.length;i++){var paneElement=__rightPaneElementsArray[i];if(paneElement){var $paneElement=$(paneElement);width=new Number($paneElement.width())-deltax;if(width<0){width=0;}paneElement.style.width=width+"px";}}}}__paneResizerMovingProcessing=false;}}}function PaneResizerMoving(){if(__paneResizerMoving==true&&navigator.appName!="Netscape"){if(__paneResizerMovingProcessing==false){__paneResizerMovingProcessing=true;var x=event.clientX;var deltax=x-__paneLocalEventXCoordinate;__paneLocalEventXCoordinate=x;if(deltax!=0){var width;for(var i=0;i<__leftPaneElementsArray.length;i++){var paneElement=__leftPaneElementsArray[i];if(paneElement){width=new Number(paneElement.style.pixelWidth)+deltax;if(width<0){width=0;}paneElement.style.pixelWidth=width;}}if(__leftPaneWidthHiddenField){if(width<0){width=0;}__leftPaneWidthHiddenField.value=width;}if(__rightPaneScrollingDisabled==false){for(var i=0;i<__rightPaneElementsArray.length;i++){var paneElement=__rightPaneElementsArray[i];if(paneElement){width=paneElement.style.pixelWidth-=deltax;if(width<0){width=0;}paneElement.style.pixelWidth=width;}}}}__paneResizerMovingProcessing=false;}}}function PaneResizerMouseUp(e){__paneResizerMoving=false;if(navigator.appName=="Netscape"){RemoveEventHandlerFromElement(document,"onmousemove",PaneResizerMovingNetscape);RemoveEventHandlerFromElement(document,"onmouseup",PaneResizerMouseUp);}else{if(__paneDividerBarElement){__paneDividerBarElement.releaseCapture();}}}var __paneLocalEventYCoordinate;var __topPaneElementsArray;var __bottomPaneElementsArray;var __topPaneHeightHiddenField;var __bottomPaneScrollingDisabled=false;function PaneResizerMouseDownUpDown(localEvent,splitScreenTableName,dividerBarName,topPanesNamesArray,bottomPanesNamesArray,topPaneHeightHiddenFieldName,bottomPaneScrollingDisabled){__paneResizerMoving=true;__topPaneElementsArray=new Array(topPanesNamesArray.length);__bottomPaneElementsArray=new Array(bottomPanesNamesArray.length);__paneDividerBarElement=GetElementById(dividerBarName);__topPaneHeightHiddenField=GetElementById(topPaneHeightHiddenFieldName);__bottomPaneScrollingDisabled=bottomPaneScrollingDisabled;for(var i=0;i<topPanesNamesArray.length;i++){var element=GetElementById(topPanesNamesArray[i])
__topPaneElementsArray[i]=element;}for(var i=0;i<bottomPanesNamesArray.length;i++){var element=GetElementById(bottomPanesNamesArray[i]);__bottomPaneElementsArray[i]=element;}if(navigator.appName=="Netscape"){__paneLocalEventYCoordinate=localEvent.pageY;AddEventHandlerToElement(document,"onmousemove",PaneResizerMovingNetscapeUpDown);AddEventHandlerToElement(document,"onmouseup",PaneResizerMouseUp);localEvent.preventDefault();}else{__paneDividerBarElement.setCapture();__paneLocalEventYCoordinate=event.clientY;}}function PaneResizerMovingNetscapeUpDown(e){if(__paneResizerMoving==true){if(__paneResizerMovingProcessing==false){__paneResizerMovingProcessing=true;var y=e.pageY;var deltay=new Number(y-__paneLocalEventYCoordinate);__paneLocalEventYCoordinate=y;if(deltay!=0){var height;for(var i=0;i<__topPaneElementsArray.length;i++){var paneElement=__topPaneElementsArray[i];if(paneElement){height=new Number(paneElement.offsetHeight)+deltay;if(height<0){height=0;}paneElement.style.height=height+"px";}}if(__topPaneHeightHiddenField){__topPaneHeightHiddenField.value=height;}if(__bottomPaneScrollingDisabled==false){for(var i=0;i<__bottomPaneElementsArray.length;i++){var paneElement=__bottomPaneElementsArray[i];if(paneElement){height=new Number(paneElement.offsetHeight)-deltay;if(width<0){height=0;}paneElement.style.height=height+"px";}}}}__paneResizerMovingProcessing=false;}}}function PaneResizerMovingUpDown(){if(__paneResizerMoving==true&&navigator.appName!="Netscape"){if(__paneResizerMovingProcessing==false){__paneResizerMovingProcessing=true;var y=event.clientY;var deltay=y-__paneLocalEventYCoordinate;__paneLocalEventYCoordinate=y;if(deltay!=0){var height;for(var i=0;i<__topPaneElementsArray.length;i++){var paneElement=__topPaneElementsArray[i];if(paneElement){height=new Number(paneElement.style.pixelHeight)+deltay;if(height<0){height=0;}paneElement.style.pixelHeight=height;}}if(__topPaneHeightHiddenField){if(height<0){height=0;}__topPaneHeightHiddenField.value=height;}if(__bottomPaneScrollingDisabled==false){for(var i=0;i<__bottomPaneElementsArray.length;i++){var paneElement=__bottomPaneElementsArray[i];if(paneElement){height=paneElement.style.pixelHeight-=deltay;if(height<0){height=0;}paneElement.style.pixelHeight=height;}}}}__paneResizerMovingProcessing=false;}}}var __tableheaderdragMoving=new Boolean(false);var __tableheaderdragXcoordinate;var __tableheaderdragHeaderElement;var __tableheaderdragHeaderWidth;var __tableheaderdragSelectedColumKey=null;var __tableheaderdragTableColumnSelector=null;var __tableheaderdragHeaderElements;var __tableheaderdragHeaderWidths;var __tableheaderdragHeaderWidthChanged=false;function TableHeaderDragStart(headerElementNames,localEvent,element,columnKey,tableColumnSelector){__tableheaderdragHeaderElement=element;__tableheaderdragSelectedColumKey=columnKey;__tableheaderdragTableColumnSelector=tableColumnSelector;__tableheaderdragHeaderElements=new Array();__tableheaderdragHeaderWidths=new Array();for(var i=0;i<headerElementNames.length;i++){var headerElement=GetElementById(headerElementNames[i]);__tableheaderdragHeaderElements[__tableheaderdragHeaderElements.length]=headerElement;__tableheaderdragHeaderWidths[__tableheaderdragHeaderWidths.length]=new Number(headerElement.offsetWidth);var headerElementFirstRow=GetElementById(headerElement.id+"_FR");if(headerElementFirstRow){__tableheaderdragHeaderElements[__tableheaderdragHeaderElements.length]=headerElementFirstRow;__tableheaderdragHeaderWidths[__tableheaderdragHeaderWidths.length]=new Number(headerElementFirstRow.offsetWidth);}}__tableheaderdragHeaderWidthChanged=false;if(navigator.appName=="Netscape"){__tableheaderdragXcoordinate=localEvent.pageX;__tableheaderdragMoving=true;AddEventHandlerToElement(document,"onmousemove",TableHeaderNetscapeDrag);AddEventHandlerToElement(document,"onmouseup",TableHeaderDragStop);localEvent.preventDefault();}else{__tableheaderdragXcoordinate=localEvent.clientX;element.setCapture();__tableheaderdragMoving=true;}};function MF_THDS(headerElementNames,localEvent,element,columnKey,tableColumnSelector){TableHeaderDragStart(headerElementNames,localEvent,element,columnKey,tableColumnSelector);};function TableHeaderDrag(){if(__tableheaderdragMoving==true&&navigator.appName!="Netscape"){var currentCoordinate=event.clientX;var deltax=currentCoordinate-__tableheaderdragXcoordinate;__tableheaderdragXcoordinate=currentCoordinate;if(deltax!=0){for(var i=0;i<__tableheaderdragHeaderElements.length;i++){var widthToChange=__tableheaderdragHeaderWidths[i]+deltax;__tableheaderdragHeaderWidths[i]=widthToChange;if(__tableheaderdragHeaderWidths[i]>0){__tableheaderdragHeaderElements[i].style.width=widthToChange+"px";}}__tableheaderdragHeaderWidthChanged=true;}}};function MF_THD(){TableHeaderDrag();};function TableHeaderNetscapeDrag(e){var currentCoordinate=e.pageX;var deltax=currentCoordinate-__tableheaderdragXcoordinate;__tableheaderdragXcoordinate=currentCoordinate;if(__tableheaderdragMoving==true){if(deltax!=0){for(var i=0;i<__tableheaderdragHeaderElements.length;i++){var widthToChange=new Number();var widthToChange=__tableheaderdragHeaderWidths[i]+deltax;__tableheaderdragHeaderWidths[i]=widthToChange;if(widthToChange>0){__tableheaderdragHeaderElements[i].style.width=widthToChange+"px";}}__tableheaderdragHeaderWidthChanged=true;}}};function TableHeaderDragStop(){var element=__tableheaderdragHeaderElement;var tableColumnSelector=__tableheaderdragTableColumnSelector;var selectedColumnKey=__tableheaderdragSelectedColumKey;if(navigator.appName=="Netscape"){RemoveEventHandlerFromElement(document,"onmousemove",TableHeaderNetscapeDrag);RemoveEventHandlerFromElement(document,"onmouseup",TableHeaderDragStop);}else{element.releaseCapture();}__tableheaderdragMoving=false;__tableheaderdragTableColumnSelector=null;__tableheaderdragSelectedColumKey=null;if(tableColumnSelector&&selectedColumnKey){var width=element.offsetWidth;var selectedColumnsArray=tableColumnSelector.SelectedColumnsArray;for(var i=0;i<selectedColumnsArray.length;i++){var tc=selectedColumnsArray[i];if(selectedColumnKey==tc.Key.toString()){tc.Width=width;var selectedColumnsListBox=GetElementById(tableColumnSelector.SelectedColumnsListBoxElementId);var selectedCount=0;var keySelected=false;for(var ii=0;ii<selectedColumnsListBox.options.length;ii++){var option=selectedColumnsListBox.options[ii];if(option.selected==true){selectedCount+=1;if(option.value==selectedColumnKey){keySelected=true;}}}if(keySelected==true&&selectedCount==1){FormTools.SetFormElementValue(tableColumnSelector.ColumnWidthTextBoxElementId,width);}break;}}if(__tableheaderdragHeaderWidthChanged==true){tableColumnSelector.SetQuickSelectToCustom();tableColumnSelector.SerializeSelectedTableColumns();}}};function MF_THDST(element,selectedColumnKey,tableColumnSelector){TableHeaderDragStop(element,selectedColumnKey,tableColumnSelector);};function TableHeaderSortClicked(sortColumnHiddenName,sortDirectionHiddenName,sortColumn){var sortColumnHidden=GetElementById(sortColumnHiddenName);var sortDirectionHidden=GetElementById(sortDirectionHiddenName);var sortColumnPrevious=sortColumnHidden.value;var sortDirectionPrevious=sortDirectionHidden.value;if(sortColumn==sortColumnPrevious){if(sortDirectionHidden.value=="0"){sortDirectionHidden.value="1";}else{sortDirectionHidden.value="0";}}else{sortColumnHidden.value=sortColumn;sortDirectionHidden.value="0";}};